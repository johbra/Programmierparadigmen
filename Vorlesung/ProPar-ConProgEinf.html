<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de">
<head>
<!-- 2018-08-20 Mon 15:33 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Constraint-Programmierung &#x2013; Intuitive Einführung</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Johannes Brauer" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="styles/bigblow/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="styles/bigblow/css/bigblow.css"/>
<link rel="stylesheet" type="text/css" href="styles/bigblow/css/hideshow.css"/>
<script type="text/javascript" src="styles/bigblow/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="styles/bigblow/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="styles/bigblow/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="styles/bigblow/js/jquery.zclip.min.js"></script>
<script type="text/javascript" src="styles/bigblow/js/bigblow.js"></script>
<script type="text/javascript" src="styles/bigblow/js/hideshow.js"></script>
<script type="text/javascript" src="styles/lib/js/jquery.stickytableheaders.min.js"></script>
<link rel="stylesheet" type="text/css" href="mycss/mystyle.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Constraint-Programmierung &#x2013; Intuitive Einführung
<br />
<span class="subtitle">Programmierparadigmen</span>
</h1>

<div id="outline-container-orgef807ce" class="outline-2">
<h2 id="orgef807ce">Einstieg</h2>
<div class="outline-text-2" id="text-orgef807ce">
<p>
Darstellungen angelehnt an <a class='org-ref-reference' href="#Fruehwirth2010">Fruehwirth2010</a> und <a class='org-ref-reference' href="#Sicp1999">Sicp1999</a>
</p>
</div>

<div id="outline-container-orgfeb009f" class="outline-3">
<h3 id="orgfeb009f">Begriff</h3>
<div class="outline-text-3" id="text-orgfeb009f">
<ul class="org-ul">
<li>Die Constraint-Programmierung wird meist als eine Spielart der
logischen Programmierung angesehen.</li>
<li>Der Begriff <i>constraint</i> bedeutet in etwa <i>Bedingung</i>,
<i>Einschränkung</i>, (<i>Regel?</i>).</li>
<li>Man könnte auch von regelbasierter Programmierung sprechen.</li>
<li>Regeln können in verschiedenen Formen auftreten:

<ul class="org-ul">
<li>funktional orientiert: mathematische Gleichungen; Beispiel:
\(x-y=23\)</li>

<li>logik-orientiert: logische Prädikate bzw. Wenn-dann-Regeln;
Beispiel:
Gesucht ist die Zahl \(x\), die ein Zahlenschloss mit den Ziffern 0
bis 9 öffnet. Wir wissen, dass \(x\)

<ul class="org-ul">
<li>\(\geq 5\),</li>

<li>eine Primzahl ist</li>
</ul></li>

<li>Regel: \(x\in {0, 1, \ldots , 9} \wedge x\geq 5 
                  \wedge prime(x)\)</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org60c0808" class="outline-3">
<h3 id="org60c0808">Prinzip</h3>
<div class="outline-text-3" id="text-org60c0808">
<ul class="org-ul">
<li>In der regelbasierten Programmierung wird ein ein Satz von Regeln
(constraints) angegeben, denen die Lösung genügen muss.</li>
<li>Es wird <b>kein</b> Algorithmus formuliert, der die Lösung Schritt für
Schritt ermittelt.</li>
<li>Ein regelbasiertes Programmiersystem muss daher über einen
eingebauten Lösungsalgorithmus (Constraint-Löser) verfügen.</li>
<li>Dieser versucht &#x2013; vereinfacht gesprochen &#x2013; einen Weltzustand zu
finden, in dem möglichst viele der angegebenen Regeln gleichzeitig
erfüllt sind.</li>
<li>Mit der Gleichung \(x-y=23\) als einziger Regel, wird der
Constraint-Löser wohl sagen müssen, dass die Regel durch unendlich
viele Belegungen von \(x\) und \(y\) erfüllt werden kann.</li>
<li>Fügt man als zweite Regel \(2x + 13 = y\) hinzu, gibt es nur noch eine
Lösung.</li>
</ul>
</div>
</div>

<div id="outline-container-org74cc306" class="outline-3">
<h3 id="org74cc306">Anwendungen</h3>
<div class="outline-text-3" id="text-org74cc306">
<ul class="org-ul">
<li>Verarbeitung natürlicher Sprachen</li>
<li>Datenbanksysteme (Konsistenzsicherung)</li>
<li>Operations Research (Optimierungsprobleme)</li>
<li>Ökonomie (Optionshandel)</li>
<li>Layout-Berechnung für integrierte Schaltungen</li>
<li>Erstellung von Stundenplänen</li>
<li>Entscheidungsunterstützungssysteme für Planung und Konfiguration</li>
<li>Kommerzielle Anwendungsbeispiele nach <a class='org-ref-reference' href="#Fruehwirth2010">Fruehwirth2010</a>
<ul class="org-ul">
<li>Lufthansa: Short-term staff planning.</li>
<li>Renault: Short-term production planning.</li>
<li>Nokia: Software configuration for mobile phones.</li>
<li>Airbus: Cabin layout.</li>
<li>Siemens: Circuit verification.</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-org336f733" class="outline-3">
<h3 id="org336f733">Contstraints im Straßenverkehr</h3>
<div class="outline-text-3" id="text-org336f733">

<div class="figure">
<p><img src="./Abbildungen/verkehr.png" alt="verkehr.png" width="600px" />
</p>
</div>


<p>
<a class='org-ref-reference' href="#Fruehwirth2010">Fruehwirth2010</a>
</p>
</div>
</div>

<div id="outline-container-orga1dec67" class="outline-3">
<h3 id="orga1dec67">Holy Grail of programming</h3>
<div class="outline-text-3" id="text-orga1dec67">
<blockquote>
<p>
Constraint Programming represents one of the closest approaches computer
science has yet made to the Holy Grail of programming: the user states
the problem, the computer solves it.
</p>

<p>
[E. Freuder]
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-org405fa32" class="outline-2">
<h2 id="org405fa32">Ein simples Constraint-propagation-system</h2>
<div class="outline-text-2" id="text-org405fa32">
<ul class="org-ul">
<li>Von Regelfortpflanzung (constraint propagation) wurde erstmals im
Programm <a href="https://de.wikipedia.org/wiki/Sketchpad">Sketchpad</a> Gebrauch gemacht, mit dessen Hilfe 1962 erstmals
Grafiken auf einem Computer-Bildschirm gezeichnet werden konnten.</li>
<li>Herkömmliche Programme (Funktionen) sind eindimensional, d. h. sie
berechnen einen Wert in Abhängigkeit von ihre Eingangsgrößen
(Argumenten).</li>
<li>Regelfortpflanzung ermöglicht den Übergang von Funktionen zu Relationen.</li>
</ul>
</div>

<div id="outline-container-org32c4617" class="outline-3">
<h3 id="org32c4617">Gleichungen</h3>
<div class="outline-text-3" id="text-org32c4617">
<ul class="org-ul">
<li>Aus der Zinseszinsrechnung ist die folgende Gleichung bekannt:
\[\frac{K_{n}}{K_{0}}=(1+\frac{p}{100})^{n}\]</li>
<li>Sie beschreibt einen Zusammenhang von vier Größen.</li>
<li>Sind drei Größen gegeben, kann die vierte berechnet werden.</li>
<li>Mit den bekannten Mitteln der Programmierung ist es aber nicht
möglich, die Gleichung und die Werte von drei Größen anzugeben, um
den Wert der vierten zu bekommen.</li>
<li>Stattdessen muss man für die Bestimmung jeder Größe eine eigene
Prozedur (Funktion) schreiben.</li>
</ul>
</div>
</div>

<div id="outline-container-org205a278" class="outline-3">
<h3 id="org205a278">Elementare Constraints</h3>
<div class="outline-text-3" id="text-org205a278">
<ul class="org-ul">
<li>Um mit Gleichungen (Relationen) direkt umgehen zu können, führen wir
als Elemente einer constraint language <i>primitive constraints</i> ein.</li>
<li>Jedes primitive constraint beschreibt einen Zusammenhang zwischen
Größen

<ul class="org-ul">
<li><code>(adder x y z)</code> legt fest, dass für die Größen \(x\), \(y\) und \(z\)
die Gleichung gilt: \(x+y=z\)</li>

<li>Entsprechend definiert <code>(multiplier x y z)</code> die Gleichung \(xy=z\).</li>

<li>Schließlich drücken wir durch <code>(constant 2.718 x)</code> aus, dass \(x\)
den Wert \(2.718\) hat.</li>
</ul></li>
<li>Um komplexere Relationen ausdrücken zu können, können constraints
durch Konnektoren verbunden werden.</li>
<li>Ein Konnektor verwaltet einen Wert, der in mehreren constraints
vorkommt.</li>
</ul>
</div>
</div>

<div id="outline-container-org92133b8" class="outline-3">
<h3 id="org92133b8">Beispiel: Celsius-Fahrenheit-Konverter</h3>
<div class="outline-text-3" id="text-org92133b8">
<ul class="org-ul">
<li>Zusammenhang zwischen Fahrenheit und Celsius: \[9C=5(F-32)\]</li>
<li>Schaltbild aus Addierern, Multiplizierern und Konstanten:</li>
</ul>

<div class="figure">
<p><img src="./Abbildungen/FahrenheitCelsiusKonverter.png" alt="FahrenheitCelsiusKonverter.png" width="600px" />
</p>
</div>
<ul class="org-ul">
<li>Die Buchstaben bezeichnen Konnektoren, die die Constraint-Elemente
verbinden, bzw. die Verbindung zu den externen Anschlüssen
herstellen.</li>
<li>Die externen Anschlüsse (hier C und F) repräsentieren die Unbekannten
aus der Gleichung.</li>
<li>Anmerkung: Das Netzwerk ähnelt einem Programm für einen
<a href="http://rechentechnik.foerderverein-tsd.de/endim2000/node1.html">Analogrechner</a>.</li>
</ul>
</div>
</div>

<div id="outline-container-org44913de" class="outline-3">
<h3 id="org44913de">Berechnungsprozess</h3>
<div class="outline-text-3" id="text-org44913de">
<ul class="org-ul">
<li>Ein Konnektor erhält einen Wert (wird aktiviert) durch
<ul class="org-ul">
<li>den Benutzer oder</li>
<li>ein Constraint-Element, mit dem er verbunden ist.</li>
</ul></li>
<li>Wenn ein Konnektor einen Wert erhalten hat, aktiviert er alle
verbundenen Constraint-Elemente &#x2013; außer demjenigen, von dem er selbst
aktiviert wurde.</li>
<li>Ein aktiviertes Constraint-Element prüft alle mit ihm verbundenen
Konnektoren daraufhin, ob genügend Informationen vorliegen, um ihm
einen Wert zu geben.</li>
<li>Wenn das der Fall ist, wird der Wert gesetzt, der Konnektor aktiviert
usw.</li>
</ul>
<ul class="org-ul">
<li>Im Celsius-Fahrenheit-Konverter erhalten die die Konnektoren w, x und
y Werte durch die mit Ihnen verbundenen Konstanten.</li>
<li>Die durch sie aktivierten Multiplzierer und der Addierer können nicht
weiterarbeiten da ihnen Information fehlen.</li>
<li>Erst wenn, C oder F durch den Benutzer einen Wert erhalten, wird ein
Wert für F bzw. C berechnet.</li>
</ul>
</div>
</div>

<div id="outline-container-org182df59" class="outline-3">
<h3 id="org182df59">Der Celsius-Fahrenheit-Konverter in Clojure</h3>
<div class="outline-text-3" id="text-org182df59">
<ul class="org-ul">
<li>Der Fahrenheit-Celsius-Konverter als black box:</li>
</ul>

<div class="figure">
<p><img src="./Abbildungen/FahrenheitCelsKonvBlackbox.png" alt="FahrenheitCelsKonvBlackbox.png" width="250px" />
</p>
</div>
<ul class="org-ul">
<li><p>
in Clojure:
</p>
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">C</span> <span style="color: #7388D6;">(</span>make-connector<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">F</span> <span style="color: #7388D6;">(</span>make-connector<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>celsius-fahrenheit-converter C F<span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">;=&gt; ok</span>
</pre>
</div></li>
</ul>

<ul class="org-ul">
<li><p>
Die Prozedur <code>celsius-fahrenheit-converter</code>
</p>
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">celsius-fahrenheit-converter</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>c f<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">let</span> <span style="color: #709870;">[</span>u <span style="color: #907373;">(</span>make-connector<span style="color: #907373;">)</span>
          v <span style="color: #907373;">(</span>make-connector<span style="color: #907373;">)</span>
          w <span style="color: #907373;">(</span>make-connector<span style="color: #907373;">)</span>
          x <span style="color: #907373;">(</span>make-connector<span style="color: #907373;">)</span>
          y <span style="color: #907373;">(</span>make-connector<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>multiplier c w u<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>multiplier v x u<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>adder v y f<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>constant 9 w<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>constant 5 x<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>constant 32 y<span style="color: #709870;">)</span>
      'ok<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-org2d61817" class="outline-3">
<h3 id="org2d61817">Anbringen von Messfühlern</h3>
<div class="outline-text-3" id="text-org2d61817">
<ul class="org-ul">
<li><p>
Die Verknüpfung eines Konnektors mit einem Messfühler (probe)
bewirkt, dass jedesmal, wenn der Konnektor einen Wert erhält, eine
Nachricht ausgegeben wird.
</p>
<pre class="example">
(probe "Celsius temp" C)
(probe "Fahrenheit temp" F)

</pre></li>
<li><p>
Beispiel: Die Auswertung von <code>(set-value! C 25 'user)</code>
führt zu folgender Ausgabe:
</p>
<pre class="example">
Probe: Celsius temp = 25
Probe: Fahrenheit temp = 77

</pre></li>
<li>Der Messfühler an <code>C</code> sorgt für die Ausgabe der Celsius-Temperatur. Die
Wertzuweisung an den Konnektor <code>C</code> pflanzt sich durch das Netzwerk
fort, wodurch der Konnektor <code>F</code> den Wert 77 erhält. Der Messfühler an <code>F</code>
sorgt wiederum für die Ausgabe.</li>
</ul>

<ul class="org-ul">
<li><p>
Der anschließende Versuch, einem Konnektor einen neuen Wert zu
geben, schlägt fehl:
</p>
<pre class="example">
(set-value! F 212 'user)
Unhandled java.lang.Exception Contradiction(77 212)

</pre></li>
<li><p>
Vorher muss der Konnektor den alten Wert vergessen. Die Auswertung
von <code>(forget-value! C 'user)</code> ergibt:
</p>
<pre class="example">
Probe: Celsius temp = ?
Probe: Fahrenheit temp = ?

</pre></li>
<li><p>
Jetzt kann <code>F</code> gesetzt werden:
</p>
<pre class="example">
(set-value! F 212 'user)
Probe: Fahrenheit temp = 212
Probe: Celsius temp = 100

</pre></li>
<li>Die Änderung an <code>F</code> pflanzt sich „rückwärts” bis zu <code>C</code> fort.</li>
<li>Beachte: Dasselbe Netzwerk wird benutzt um <code>F</code> bei gegebenem <code>C</code> zu
berechnen, und umgekehrt.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org426cb16" class="outline-2">
<h2 id="org426cb16">Implementierung des Constraint-Systems</h2>
<div class="outline-text-2" id="text-org426cb16">
</div>
<div id="outline-container-org1e9e732" class="outline-3">
<h3 id="org1e9e732">Struktur des <code>adder</code></h3>
<div class="outline-text-3" id="text-org1e9e732">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">adder</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>a1 a2 sum<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span>
        <span style="color: #709870;">[</span><span style="color: #907373;">(</span>process-new-value <span style="color: #6276BA;">[]</span> ...<span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>process-forget-value <span style="color: #6276BA;">[]</span> ...<span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>me <span style="color: #6276BA;">[</span>request<span style="color: #6276BA;">]</span>
           <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span>
             <span style="color: #858580;">(</span>= request 'I-have-a-value<span style="color: #858580;">)</span>  <span style="color: #858580;">(</span>process-new-value<span style="color: #858580;">)</span>
             <span style="color: #858580;">(</span>= request 'I-lost-my-value<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>process-forget-value<span style="color: #858580;">)</span>
             <span style="color: #D0372D;">:else</span> 
             <span style="color: #858580;">(</span><span style="color: #0000FF;">throw</span> <span style="color: #80A880;">(</span>Exception. <span style="color: #008000;">"Unknown request -- ADDER"</span> request<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>connect a1 me<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>connect a2 me<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>connect sum me<span style="color: #709870;">)</span>
      me<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
<ul class="org-ul">
<li><code>adder</code> ist als Prozedur mit <b>lokalem Zustand</b> definiert.</li>
<li>Sie liefert die lokale Prozedur <code>me</code> als Wert zurück.</li>
<li>Ein <code>adder</code> besitzt die Konnektoren <code>a1</code>, <code>a2</code> und <code>sum</code>.</li>
<li><p>
<code>adder</code> besitzt zwei weitere lokale Hilfsfunktionen:
</p>
<ul class="org-ul">
<li><code>process-new-value</code></li>
<li><code>process-forget-value</code>,</li>
</ul>
<p>
die weiter unten definiert werden.
</p></li>
<li>Auf den folgenden Folien werden zunächst Basisoperationen für
Konnektoren definiert.</li>
</ul>
</div>
</div>

<div id="outline-container-org1ceb233" class="outline-3">
<h3 id="org1ceb233">Basisoperationen für Konnektoren</h3>
<div class="outline-text-3" id="text-org1ceb233">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">has-value?: connector -&gt; boolean</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sagt, ob Konnektor einen Wert hat</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">has-value?</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>connector<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>connector 'has-value?<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">get-value: connector -&gt; any</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">liefert den Wert eines Konnektors</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">get-value</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>connector<span style="color: #909183;">]</span>
    @<span style="color: #909183;">(</span>connector 'value<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">set-value!: connector any constraint -&gt; unspecified</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">zeigt an, dass ein constraint den Wert eines Konnektors</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">setzen will</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">set-value!</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>connector new-value informant<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #709870;">(</span>connector 'set-value!<span style="color: #709870;">)</span> new-value informant<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">forget-value!: connector constraint -&gt; unspecified</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">zeigt an, dass ein constraint den Wert eines Konnektors</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">vergessen machen will</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">forget-value!</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>connector retractor<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #709870;">(</span>connector 'forget<span style="color: #709870;">)</span> retractor<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">connect: connector constraint -&gt; ?</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">verbindet einen Konnektor mit einem neuen constraint</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">connect</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>connector new-constraint<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #709870;">(</span>connector 'connect<span style="color: #709870;">)</span> new-constraint<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>

<div id="outline-container-orge9e1e97" class="outline-4">
<h4 id="orge9e1e97">Lokale Hilfsfunktionen für <code>adder</code></h4>
<div class="outline-text-4" id="text-orge9e1e97">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span>process-new-value <span style="color: #7388D6;">[]</span>
           <span style="color: #7388D6;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>has-value? a1<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>has-value? a2<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                 <span style="color: #909183;">(</span>set-value! sum
                             <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>get-value a1<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>get-value a2<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                             me<span style="color: #909183;">)</span>

                 <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>has-value? a1<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>has-value? sum<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                 <span style="color: #909183;">(</span>set-value! a2
                             <span style="color: #709870;">(</span>- <span style="color: #907373;">(</span>get-value sum<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>get-value a1<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                             me<span style="color: #909183;">)</span>

                 <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>has-value? a2<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>has-value? sum<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                 <span style="color: #909183;">(</span>set-value! a1
                             <span style="color: #709870;">(</span>- <span style="color: #907373;">(</span>get-value sum<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>get-value a2<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                             me<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span>process-forget-value <span style="color: #7388D6;">[]</span>
           <span style="color: #7388D6;">(</span>forget-value! sum me<span style="color: #7388D6;">)</span>
           <span style="color: #7388D6;">(</span>forget-value! a1 me<span style="color: #7388D6;">)</span>
           <span style="color: #7388D6;">(</span>forget-value! a2 me<span style="color: #7388D6;">)</span>
           <span style="color: #7388D6;">(</span>process-new-value<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaa75dbe" class="outline-4">
<h4 id="orgaa75dbe">Struktur des <code>multiplier</code></h4>
<div class="outline-text-4" id="text-orgaa75dbe">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">multiplier</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>m1 m2 product<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span>process-new-value <span style="color: #6276BA;">[]</span> ...<span style="color: #907373;">)</span>
            <span style="color: #907373;">(</span>process-forget-value <span style="color: #6276BA;">[]</span> ...<span style="color: #907373;">)</span>
            <span style="color: #907373;">(</span>me <span style="color: #6276BA;">[</span>request<span style="color: #6276BA;">]</span>
              <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #858580;">(</span>= request 'I-have-a-value<span style="color: #858580;">)</span>  <span style="color: #858580;">(</span>process-new-value<span style="color: #858580;">)</span>
                    <span style="color: #858580;">(</span>= request 'I-lost-my-value<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>process-forget-value<span style="color: #858580;">)</span>
                    <span style="color: #D0372D;">:else</span>
                    <span style="color: #858580;">(</span><span style="color: #0000FF;">throw</span> <span style="color: #80A880;">(</span>Exception. <span style="color: #008000;">"Unknown request -- MULTIPLIER"</span> request<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>connect m1 me<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>connect m2 me<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>connect product me<span style="color: #709870;">)</span>
      me<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org13021dc" class="outline-4">
<h4 id="org13021dc">Lokale Hilfsfunktionen für <code>multiplier</code></h4>
<div class="outline-text-4" id="text-org13021dc">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span>process-new-value <span style="color: #7388D6;">[]</span>
              <span style="color: #7388D6;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #909183;">(</span><span style="color: #0000FF;">or</span> <span style="color: #709870;">(</span><span style="color: #0000FF;">and</span> <span style="color: #907373;">(</span>has-value? m1<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>= <span style="color: #6276BA;">(</span>get-value m1<span style="color: #6276BA;">)</span> 0<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                        <span style="color: #709870;">(</span><span style="color: #0000FF;">and</span> <span style="color: #907373;">(</span>has-value? m2<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>= <span style="color: #6276BA;">(</span>get-value m2<span style="color: #6276BA;">)</span> 0<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                    <span style="color: #909183;">(</span>set-value! product 0 me<span style="color: #909183;">)</span>

                    <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>has-value? m1<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>has-value? m2<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                    <span style="color: #909183;">(</span>set-value! product
                                <span style="color: #709870;">(</span>* <span style="color: #907373;">(</span>get-value m1<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>get-value m2<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                                me<span style="color: #909183;">)</span>

                    <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>has-value? product<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>has-value? m1<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                    <span style="color: #909183;">(</span>set-value! m2
                                <span style="color: #709870;">(</span>/ <span style="color: #907373;">(</span>get-value product<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>get-value m1<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                                me<span style="color: #909183;">)</span>

                    <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>has-value? product<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>has-value? m2<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                    <span style="color: #909183;">(</span>set-value! m1
                                <span style="color: #709870;">(</span>/ <span style="color: #907373;">(</span>get-value product<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>get-value m2<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                                me<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span>process-forget-value <span style="color: #7388D6;">[]</span>
              <span style="color: #7388D6;">(</span>forget-value! product me<span style="color: #7388D6;">)</span>
              <span style="color: #7388D6;">(</span>forget-value! m1 me<span style="color: #7388D6;">)</span>
              <span style="color: #7388D6;">(</span>forget-value! m2 me<span style="color: #7388D6;">)</span>
              <span style="color: #7388D6;">(</span>process-new-value<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb962b7d" class="outline-3">
<h3 id="orgb962b7d">Der Konstantenerzeuger</h3>
<div class="outline-text-3" id="text-orgb962b7d">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">constant</span> 
   <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>value connector<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span> 
        <span style="color: #709870;">[</span><span style="color: #907373;">(</span>me <span style="color: #6276BA;">[</span>request<span style="color: #6276BA;">]</span>
           <span style="color: #6276BA;">(</span><span style="color: #0000FF;">throw</span> <span style="color: #858580;">(</span>Exception. <span style="color: #008000;">"Unknown request -- CONSTANT"</span> request<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>connect connector me<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>set-value! connector value me<span style="color: #709870;">)</span>
      me<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>        
</pre>
</div>
<ul class="org-ul">
<li>setzt den Wert des angegebenen Konnektors.</li>
<li>Nachrichten <code>I-have-a-value</code> oder <code>I-lost-my-value</code> sind unzulässig.</li>
</ul>
</div>
</div>

<div id="outline-container-org673fb91" class="outline-3">
<h3 id="org673fb91">Der Messfühler</h3>
<div class="outline-text-3" id="text-org673fb91">
<p>
Der Messfühler gibt beim Setzen bzw. Vergessen des Wertes des mit ihm
verbundenen Konnektors einen Text aus.
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">probe</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>name connector<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span> 
        <span style="color: #709870;">[</span><span style="color: #907373;">(</span>print-probe <span style="color: #6276BA;">[</span>value<span style="color: #6276BA;">]</span>
           <span style="color: #6276BA;">(</span><span style="color: #006FE0;">println</span> <span style="color: #008000;">"Probe: "</span> name <span style="color: #008000;">" = "</span> value<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>process-new-value <span style="color: #6276BA;">[]</span>
           <span style="color: #6276BA;">(</span>print-probe <span style="color: #858580;">(</span>get-value connector<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>process-forget-value <span style="color: #6276BA;">[]</span>
           <span style="color: #6276BA;">(</span>print-probe <span style="color: #008000;">"?"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
         <span style="color: #907373;">(</span>me <span style="color: #6276BA;">[</span>request<span style="color: #6276BA;">]</span>
           <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span>
             <span style="color: #858580;">(</span>= request 'I-have-a-value<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>process-new-value<span style="color: #858580;">)</span>
             <span style="color: #858580;">(</span>= request 'I-lost-my-value<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>process-forget-value<span style="color: #858580;">)</span>
             <span style="color: #D0372D;">:else</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">throw</span> <span style="color: #80A880;">(</span>Exception. <span style="color: #008000;">"Unknown request -- PROBE"</span> request<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>connect connector me<span style="color: #709870;">)</span>
      me<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0d0285a" class="outline-3">
<h3 id="org0d0285a">Konnektoren</h3>
<div class="outline-text-3" id="text-org0d0285a">
<ul class="org-ul">
<li><p>
Ein Konnektor wird als Prozedur mit drei lokalen Zustandsvariablen
und vier lokalen Prozeduren definiert:
</p>
<div class="small">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">make-connector</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">let</span> <span style="color: #709870;">[</span>value <span style="color: #907373;">(</span><span style="color: #006FE0;">atom</span> <span style="color: #D0372D;">false</span><span style="color: #907373;">)</span> informant <span style="color: #907373;">(</span><span style="color: #006FE0;">atom</span> <span style="color: #D0372D;">false</span><span style="color: #907373;">)</span> constraints  <span style="color: #907373;">(</span><span style="color: #006FE0;">atom</span> '<span style="color: #6276BA;">()</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span><span style="color: #0000FF;">letfn</span> <span style="color: #907373;">[</span> ... <span style="color: #907373;">]</span>
        me<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

</div>
<dl class="org-dl">
<dt>value</dt><dd>repäsentiert den aktuellen Wert des Konnektors,</dd>
<dt>informant</dt><dd>repräsentiert das Objekt, das den Wert gesetzt hat,</dd>
<dt>constraints</dt><dd>enthält die Liste der Constraint-Elemente, mit
denen der Konnektor verbunden ist und die bei Änderungen seines
Wertes informiert werden müssen.</dd>
</dl></li>
</ul>
</div>

<div id="outline-container-org2132055" class="outline-4">
<h4 id="org2132055"><code>make-connector -- set-my-value</code></h4>
<div class="outline-text-4" id="text-org2132055">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span>set-my-value <span style="color: #7388D6;">[</span>newval setter<span style="color: #7388D6;">]</span>
                <span style="color: #7388D6;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #909183;">(</span><span style="color: #006FE0;">not</span> <span style="color: #709870;">(</span>has-value? me<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                      <span style="color: #909183;">(</span><span style="color: #0000FF;">do</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">reset!</span> value newval<span style="color: #709870;">)</span>
                          <span style="color: #709870;">(</span><span style="color: #006FE0;">reset!</span> informant setter<span style="color: #709870;">)</span>
                          <span style="color: #709870;">(</span>for-each-except setter
                                           inform-about-value
                                           constraints<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                      <span style="color: #909183;">(</span><span style="color: #006FE0;">not</span> <span style="color: #709870;">(</span>= @value newval<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                      <span style="color: #909183;">(</span><span style="color: #0000FF;">throw</span> <span style="color: #709870;">(</span>Exception. <span style="color: #907373;">(</span><span style="color: #006FE0;">str</span> <span style="color: #008000;">"Contradiction"</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">list</span> @value newval<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                      <span style="color: #D0372D;">:else</span> 'ignored<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
<ul class="org-ul">
<li>Wird aufgerufen, wenn der Wert des Konnektors gesetzt werden soll.</li>
<li>Wenn der Konnektor noch keinen Wert besitzt, wird er gesetzt und der
Informant vermerkt.</li>
<li>In diesem Fall werden alle verbundenen Constraint-Elemente (mit
Ausnahme des Informanten) darüber informiert.</li>
</ul>
</div>
</div>

<div id="outline-container-orgd3614f0" class="outline-4">
<h4 id="orgd3614f0"><code>make-connector -- forget-my-value</code></h4>
<div class="outline-text-4" id="text-orgd3614f0">
<div class="small">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span>forget-my-value <span style="color: #7388D6;">[</span>retractor<span style="color: #7388D6;">]</span>
                <span style="color: #7388D6;">(</span><span style="color: #0000FF;">if</span> <span style="color: #909183;">(</span>= retractor @informant<span style="color: #909183;">)</span>
                  <span style="color: #909183;">(</span><span style="color: #0000FF;">do</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">reset!</span> informant <span style="color: #D0372D;">false</span><span style="color: #709870;">)</span>
                      <span style="color: #709870;">(</span>for-each-except retractor
                                       inform-about-no-value
                                       constraints<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                  'ignored<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

</div>
<ul class="org-ul">
<li>Wird aufgerufen, wenn ein der Wert des Konnektors vergessen werden
soll.</li>
<li>Hier wird geprüft, ob diese Anforderung von demselben Objekt stammt,
das das Setzen des Wertes angefordert hat.</li>
<li>In diesem Fall werden alle verbundenen Constraint-Elemente (mit
Ausnahme des Informanten) darüber informiert.</li>
</ul>
</div>
</div>

<div id="outline-container-orgef2844a" class="outline-4">
<h4 id="orgef2844a"><code>make-connector -- connect</code></h4>
<div class="outline-text-4" id="text-orgef2844a">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span>connect <span style="color: #7388D6;">[</span>new-constraint<span style="color: #7388D6;">]</span>
                <span style="color: #7388D6;">(</span><span style="color: #0000FF;">if</span> <span style="color: #909183;">(</span><span style="color: #006FE0;">not</span> <span style="color: #709870;">(</span>in? @constraints new-constraint <span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                  <span style="color: #909183;">(</span><span style="color: #006FE0;">swap!</span> constraints conj new-constraint<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #0000FF;">if</span> <span style="color: #909183;">(</span>has-value? me<span style="color: #909183;">)</span>
                  <span style="color: #909183;">(</span>inform-about-value new-constraint<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                'done<span style="color: #707183;">)</span>
</pre>
</div>
<ul class="org-ul">
<li>fügt, das neue Constraint-Element der Liste der verbundenen
Constraint-Elemente hinzu, falls es dort noch nicht enthalten ist.</li>
<li>Wenn der Konnektor einen Wert besitzt, wird das neue
Constraint-Element darüber informiert.</li>
</ul>
</div>
</div>

<div id="outline-container-orgfdc824b" class="outline-4">
<h4 id="orgfdc824b"><code>make-connector -- me</code></h4>
<div class="outline-text-4" id="text-orgfdc824b">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span>me <span style="color: #7388D6;">[</span>request<span style="color: #7388D6;">]</span>
                <span style="color: #7388D6;">(</span><span style="color: #0000FF;">cond</span>
                  <span style="color: #909183;">(</span>= request 'has-value?<span style="color: #909183;">)</span> <span style="color: #909183;">(</span><span style="color: #0000FF;">if</span> @informant <span style="color: #D0372D;">true</span> <span style="color: #D0372D;">false</span><span style="color: #909183;">)</span>
                  <span style="color: #909183;">(</span>= request 'value<span style="color: #909183;">)</span>      value
                  <span style="color: #909183;">(</span>= request 'set-value!<span style="color: #909183;">)</span> set-my-value
                  <span style="color: #909183;">(</span>= request 'forget<span style="color: #909183;">)</span>     forget-my-value
                  <span style="color: #909183;">(</span>= request 'connect<span style="color: #909183;">)</span>    connect
                  <span style="color: #D0372D;">:else</span> <span style="color: #909183;">(</span><span style="color: #0000FF;">throw</span> <span style="color: #709870;">(</span>Exception. <span style="color: #008000;">"Unknown operation -- CONNECTOR"</span>
                                           request<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
<ul class="org-ul">
<li>Dient als Verteiler für die anderen lokalen Prozduren.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org9691d43" class="outline-3">
<h3 id="org9691d43">Hilfsprozeduren</h3>
<div class="outline-text-3" id="text-org9691d43">
<ul class="org-ul">
<li>Es fehlen jetzt noch die Prozeduren:
<ul class="org-ul">
<li><code>for-each-except</code></li>
<li><code>inform-about-value</code></li>
<li><code>inform-about-no-value</code></li>
</ul></li>
</ul>
</div>

<div id="outline-container-orgd3dc616" class="outline-4">
<h4 id="orgd3dc616">Iterator <code>for-each-except</code></h4>
<div class="outline-text-4" id="text-orgd3dc616">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">for-each-except</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>exception procedure list<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span>
        <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">loop</span> <span style="color: #6276BA;">[</span>items<span style="color: #6276BA;">]</span>
           <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span>
             <span style="color: #858580;">(</span><span style="color: #006FE0;">empty?</span> items<span style="color: #858580;">)</span> 'done
             <span style="color: #858580;">(</span>= <span style="color: #80A880;">(</span><span style="color: #006FE0;">first</span> items<span style="color: #80A880;">)</span> exception<span style="color: #858580;">)</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">loop</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">rest</span> items<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
             <span style="color: #D0372D;">:else</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">do</span> <span style="color: #80A880;">(</span>procedure <span style="color: #887070;">(</span><span style="color: #006FE0;">first</span> items<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                       <span style="color: #80A880;">(</span><span style="color: #0000FF;">loop</span> <span style="color: #887070;">(</span><span style="color: #006FE0;">rest</span> items<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span><span style="color: #0000FF;">loop</span> @list<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
        
</pre>
</div>
<ul class="org-ul">
<li>Führt auf allen Elementen einer Liste die Prozedur <code>procedure</code> aus,
mit Ausnahme des Elements <code>exception</code>.</li>
</ul>
</div>
</div>

<div id="outline-container-org35f15e4" class="outline-4">
<h4 id="org35f15e4"><code>inform-about-…</code></h4>
<div class="outline-text-4" id="text-org35f15e4">
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">inform-about-value</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>constraint<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>constraint 'I-have-a-value<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">inform-about-no-value</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>constraint<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span>constraint 'I-lost-my-value<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
<ul class="org-ul">
<li>Dienen lediglioch der besseren Lesbarkeit des Programms.</li>
<li>„Syntaktische” Prozeduren</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-org52b92d3" class="outline-2">
<h2 id="org52b92d3">Literatur</h2>
</div>
<div id="outline-container-org5665971" class="outline-2">
<h2 id="org5665971"><h2>Literaturverzeichnis</h2>
<ul class='org-ref-bib'><li><a id="Fruehwirth2010">[Fruehwirth2010]</a> <a name="Fruehwirth2010"></a>Thom Frühwirth & Slim Abdennadher, Essentials of Constraint Programming (Cognitive Technologies), Springer (2010).</li>
<li><a id="Sicp1999">[Sicp1999]</a> <a name="Sicp1999"></a>Harold Abelson, Gerald Jay Sussman & Julie Sussman, Structure and interpretation of computer programs, The MIT Press (1999).</li>
</ul></h2>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Autor: Johannes Brauer</p>
<p class="date">Created: 2018-08-20 Mon 15:33</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>