<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de">
<head>
<!-- 2017-09-20 Wed 11:07 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Programmierparadigmen</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Johannes Brauer" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="styles/bigblow/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="styles/bigblow/css/bigblow.css"/>
<link rel="stylesheet" type="text/css" href="styles/bigblow/css/hideshow.css"/>
<script type="text/javascript" src="styles/bigblow/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="styles/bigblow/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="styles/bigblow/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="styles/bigblow/js/jquery.zclip.min.js"></script>
<script type="text/javascript" src="styles/bigblow/js/bigblow.js"></script>
<script type="text/javascript" src="styles/bigblow/js/hideshow.js"></script>
<script type="text/javascript" src="styles/lib/js/jquery.stickytableheaders.min.js"></script>
<link rel="stylesheet" type="text/css" href="mycss/mystyle.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Programmierparadigmen
<br />
<span class="subtitle">Aufgaben &#x2013; Lösungen</span>
</h1>

<div id="outline-container-orga30ea6c" class="outline-2">
<h2 id="orga30ea6c"><span class="section-number-2">1</span> Teil 1 (5. Semester)</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-org892c49c" class="outline-3">
<h3 id="org892c49c"><span class="section-number-3">1.1</span> Aufgabe (SEND-MORE-MONEY)</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Lösen Sie das SEND-MORE-MONEY-Problem aus der Vorlesung (<a href="ProPar-Einstieg.html#aufgabe1">Aufgabe: Mehr
Geld bitte!</a>) in einer Programmiersprache Ihrer Wahl! Beachten Sie
Nebenbedingungen.
</p>
</div>
</div>

<div id="outline-container-org8017ac0" class="outline-3">
<h3 id="org8017ac0"><span class="section-number-3">1.2</span> Aufgabe (Beweis Pkw-Motorräder-Problem)</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Führen Sie für das Pkw-Motorräder-Problem aus der <a href="ProPar-Einstieg.html#aufgabePkw">Vorlesung</a> den dort
verlangten Beweis!
</p>
</div>
</div>

<div id="outline-container-orgf69e9eb" class="outline-3">
<h3 id="orgf69e9eb"><span class="section-number-3">1.3</span> Aufgabe (Entwurfsvorschrift I)</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Schreiben Sie gemäß Entwurfsvorschrift I den Vertrag, die
Zweckbestimmung für eine Funktion auf, die den Rauminhalt eines Quaders
berechnet, für den Länge, Breite und Höhe gegeben ist. Formulieren Sie
drei Beispielanwendungen als Tests, die das Verhalten der Funktion
veranschaulichen.
</p>
</div>
</div>

<div id="outline-container-orgc43657e" class="outline-3">
<h3 id="orgc43657e"><span class="section-number-3">1.4</span> Aufgabe (Entwurfsvorschrift I)</h3>
<div class="outline-text-3" id="text-1-4">
<ol class="org-ol">
<li><p>
Eine Funktion, die aus der Entfernung und der Geschwindigkeit zweier
Züge die Zeit ermittelt, nach der die Züge sich treffen, wenn Sie
sich auf einem gemeinsamen Streckenabschnitt von ihren jeweiligen
Startpunkten aus aufeinander zu bewegen.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet, wie lange es dauert bis die zwei Zuege</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sich treffen</span>
       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">zeit-bis-treffen</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>v-zug1 v-zug2 entfernung<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> v-zug1<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> v-zug2<span style="color: #907373;">)</span> 
                  <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> entfernung<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span>/ entfernung <span style="color: #709870;">(</span>+ v-zug1 v-zug2<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-zeit-bis-treffen</span> 
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 1 <span style="color: #709870;">(</span>zeit-bis-treffen 50 50 100<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>/ 4 3<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>zeit-bis-treffen 25 50 100<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
         </pre>
</pre>
</div></li>

<li><p>
Eine Funktion, die aus einem gegebenen Anfangskapital, einem
Jahreszinssatz und einer in Monaten gemessenen Laufzeit das
Endkapital ermittelt. Die Zinsgutschrift erfolgt einmalig am Ende der
Laufzeit. Während der Laufzeit gibt es weder Einzahlungen noch
Abhebungen.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">compute balance with simple interest</span>
       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">balance</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>principal rate duration<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> principal<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> rate<span style="color: #907373;">)</span>
                  <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> duration<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span>+ principal <span style="color: #709870;">(</span>* principal 
                           <span style="color: #907373;">(</span>/ <span style="color: #6276BA;">(</span>* rate <span style="color: #858580;">(</span>/ 1 100<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span> 12<span style="color: #907373;">)</span> duration<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-balance</span> 
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 1000 <span style="color: #709870;">(</span>balance 1000 10 0<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 1100 <span style="color: #709870;">(</span>balance 1000 10 12<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
           </pre>
</pre>
</div></li>

<li><p>
Eine Funktion, die aus der Länge und Breite eines rechteckigen
Fußbodens, die Anzahl der benötigten Fliesen berechnet, deren Größe
ebenfalls durch Länge und Breite gegeben ist.
</p>

<p>
Hinweis: Der Funktionsaufruf <code>(Math/ceil x)</code> liefert die/ kleinste
ganze Zahl, die größer als x ist.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">compute number of full tiles necessary for floor</span>
       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">tiles</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>f-length f-width t-length t-width<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> f-length<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> f-width<span style="color: #907373;">)</span> 
                  <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> t-length<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> t-width<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span>* <span style="color: #709870;">(</span><span style="color: #6434A3;">Math</span><span style="font-family: DejaVu Sans Mono,monospace,sans-serif; color: #000000; background-color: #FFFFFF;">/</span>ceil <span style="color: #907373;">(</span>/ f-width t-width<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
              <span style="color: #709870;">(</span><span style="color: #6434A3;">Math</span><span style="font-family: DejaVu Sans Mono,monospace,sans-serif; color: #000000; background-color: #FFFFFF;">/</span>ceil <span style="color: #907373;">(</span>/ f-length t-length<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-fliesen</span> 
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 100.0 <span style="color: #709870;">(</span>tiles 10 10 1 1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 400.0 <span style="color: #709870;">(</span>tiles 24 37 <span style="color: #907373;">(</span>/ 3 2<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>/ 3 2<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
          </pre>
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-orgd5883bb" class="outline-3">
<h3 id="orgd5883bb"><span class="section-number-3">1.5</span> Aufgabe (Bedingte Funktionen)</h3>
<div class="outline-text-3" id="text-1-5">
<p>
Schreiben Sie ein Programm, das aus dem Bruttoeinkommen eines
Arbeitnehmers, das sich aus der Anzahl der Arbeitsstunden und seinem
Bruttostundenlohn ergibt, sein Nettoeinkommen durch Abzug der
Einkommensteuer berechnet. Die Einkommensteuer wird dabei nach einem
steuererklärungaufbierdeckelgeeigneten Tarif ermittelt, der
folgendermaßen definiert ist:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left"><b>Einkommen</b></th>
<th scope="col" class="org-right"><b>Steuersatz</b> [%]</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">\(<= 5000\)</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-left">\(> 5000\) und \(\leq 10000\)</td>
<td class="org-right">15</td>
</tr>

<tr>
<td class="org-left">\(>10000\) und \(\leq 100000\)</td>
<td class="org-right">29</td>
</tr>

<tr>
<td class="org-left">\(>100000\)</td>
<td class="org-right">64</td>
</tr>
</tbody>
</table>

<p>
Der Steuersatz gilt immer nur für die Einkommensanteile in dem
jeweiligen Intervall.
</p>

<p>
Die Funktion <code>nettoeinkommen</code> soll nach folgendem Schema aufrufbar sein:
</p>

<div class="org-src-container">
<pre class="src src-clojure">          <span style="color: #707183;">(</span>nettoeinkommen <span style="color: #808080;">anzahlArbeitsStunden</span> <span style="color: #808080;">stundenLohn</span><span style="color: #707183;">)</span></pre>
</pre>
</div>

<p>
Hier noch ein paar Testvorgaben:
</p>

<div class="org-src-container">
<pre class="src src-clojure">    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-nettoeinkommen</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>/ 500085 100<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>nettoeinkommen 1 5001<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>/ 925071 100<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>nettoeinkommen 1 10001<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>/ 7315036 100<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>nettoeinkommen 1 100001<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>

<p>
Hinweise:
</p>

<ol class="org-ol">
<li>Lesen Sie den Aufgabentext aufmerksam durch. Jeder Satz bedeutet
etwas.</li>

<li>Entwickeln Sie die Funktion gemäß Entwurfsvorschrift II. Benutzen Sie
Hilfsfunktionen und machen von Variablendefinitionen Gebrauch.</li>

<li>Um das Rechnen mit inexakten Zahlen zu vermeiden, geben Sie
Steuersätze nicht als Gleitkommazahlen wie 0.29 sondern als rationale
Zahlen ein. In diesem Beispiel: (/ 29 100)</li>
</ol>

<div class="org-src-container">
<pre class="src src-clojure">    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">steuergrenzeI</span>     5000<span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">steuergrenzeII</span>   10000<span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">steuergrenzeIII</span> 100000<span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">steuersatzI</span>    0<span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">steuersatzII</span>  15<span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">steuersatzIII</span> 29<span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">steuersatzIV</span>  64<span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">=======================================================</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Ermittlung des Einkommensteuersatz</span>
    <span style="color: #8D8D84;">;;</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Einkommen             | Steuersatz (%)</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">&lt;= 5000               |  0</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">&gt; 5000 und &lt;= 10000   | 15</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">&gt; 10000 und &lt;= 100000 | 29</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">&gt; 100000              | 64</span>
    <span style="color: #8D8D84;">;;</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eingabeparameter: Einkommen (in Euro)</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Resultat: Steuersatz (in Prozent)</span>
    <span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">=======================================================</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">steuersatz</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>einkommen<span style="color: #909183;">]</span>
        <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> einkommen<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span><span style="color: #0000FF;">and</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">pos?</span> einkommen<span style="color: #907373;">)</span>
               <span style="color: #907373;">(</span>&lt;= einkommen <span style="color: #808080;">steuergrenzeI</span><span style="color: #907373;">)</span> <span style="color: #709870;">)</span>  <span style="color: #808080;">steuersatzI</span>
          <span style="color: #709870;">(</span><span style="color: #0000FF;">and</span> <span style="color: #907373;">(</span>&gt; einkommen <span style="color: #808080;">steuergrenzeI</span><span style="color: #907373;">)</span>
               <span style="color: #907373;">(</span>&lt;= einkommen <span style="color: #808080;">steuergrenzeII</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>  <span style="color: #808080;">steuersatzII</span>
          <span style="color: #709870;">(</span><span style="color: #0000FF;">and</span> <span style="color: #907373;">(</span>&gt; einkommen <span style="color: #808080;">steuergrenzeII</span><span style="color: #907373;">)</span>
               <span style="color: #907373;">(</span>&lt;= einkommen <span style="color: #808080;">steuergrenzeIII</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #808080;">steuersatzIII</span>
          <span style="color: #709870;">(</span>&gt; einkommen <span style="color: #808080;">steuergrenzeIII</span><span style="color: #709870;">)</span>        <span style="color: #808080;">steuersatzIV</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-steuersatz</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #808080;">steuersatzI</span>   <span style="color: #709870;">(</span>steuersatz 2000<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #808080;">steuersatzI</span>   <span style="color: #709870;">(</span>steuersatz <span style="color: #808080;">steuergrenzeI</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #808080;">steuersatzII</span>  <span style="color: #709870;">(</span>steuersatz 7500<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #808080;">steuersatzII</span>  <span style="color: #709870;">(</span>steuersatz <span style="color: #808080;">steuergrenzeII</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #808080;">steuersatzIII</span> <span style="color: #709870;">(</span>steuersatz 50000<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #808080;">steuersatzIII</span> <span style="color: #709870;">(</span>steuersatz <span style="color: #808080;">steuergrenzeIII</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #808080;">steuersatzIV</span>  <span style="color: #709870;">(</span>steuersatz 1000000<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">=======================================================</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Ermittlung der Einkommensteuer</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eingabeparameter: Einkommen (in Euro)</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Resultat: Einkommensteuerbetrag (in Euro)</span>
    <span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">=======================================================</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">einkommensteuer</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>einkommen<span style="color: #909183;">]</span>
        <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> einkommen<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span>= <span style="color: #907373;">(</span>steuersatz einkommen<span style="color: #907373;">)</span> <span style="color: #808080;">steuersatzI</span><span style="color: #709870;">)</span>
            <span style="color: #709870;">(</span>/ <span style="color: #808080;">steuersatzI</span> 100<span style="color: #709870;">)</span>
          <span style="color: #709870;">(</span>= <span style="color: #907373;">(</span>steuersatz einkommen<span style="color: #907373;">)</span> <span style="color: #808080;">steuersatzII</span><span style="color: #709870;">)</span>
            <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>einkommensteuer <span style="color: #808080;">steuergrenzeI</span><span style="color: #907373;">)</span>
               <span style="color: #907373;">(</span>* <span style="color: #6276BA;">(</span>- einkommen <span style="color: #808080;">steuergrenzeI</span><span style="color: #6276BA;">)</span>
                 <span style="color: #6276BA;">(</span>/ <span style="color: #808080;">steuersatzII</span> 100<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
          <span style="color: #709870;">(</span>= <span style="color: #907373;">(</span>steuersatz einkommen<span style="color: #907373;">)</span> <span style="color: #808080;">steuersatzIII</span><span style="color: #709870;">)</span>
            <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>einkommensteuer <span style="color: #808080;">steuergrenzeII</span><span style="color: #907373;">)</span>
               <span style="color: #907373;">(</span>* <span style="color: #6276BA;">(</span>- einkommen <span style="color: #808080;">steuergrenzeII</span><span style="color: #6276BA;">)</span>
                 <span style="color: #6276BA;">(</span>/ <span style="color: #808080;">steuersatzIII</span> 100<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
          <span style="color: #709870;">(</span>= <span style="color: #907373;">(</span>steuersatz einkommen<span style="color: #907373;">)</span> <span style="color: #808080;">steuersatzIV</span><span style="color: #709870;">)</span>
            <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span>einkommensteuer <span style="color: #808080;">steuergrenzeIII</span><span style="color: #907373;">)</span>
               <span style="color: #907373;">(</span>* <span style="color: #6276BA;">(</span>- einkommen <span style="color: #808080;">steuergrenzeIII</span><span style="color: #6276BA;">)</span>
                 <span style="color: #6276BA;">(</span>/ <span style="color: #808080;">steuersatzIV</span> 100<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-einkommensteuer</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 750 <span style="color: #709870;">(</span>einkommensteuer 10000<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">=======================================================</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Berechnung des Bruttoeinkommens eines Arbeitnehmers</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eingabeparameter: Anzahl Arbeitsstunden,</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Bruttostundenlohn (in Euro)</span>
    <span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">=======================================================</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">bruttoeinkommen</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>arbeitsstunden stundenlohn<span style="color: #909183;">]</span>
        <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> arbeitsstunden<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> stundenlohn<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
        <span style="color: #909183;">(</span>* arbeitsstunden stundenlohn<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-bruttoeinkommen</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 50 <span style="color: #709870;">(</span>bruttoeinkommen 10 5<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">=======================================================</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Berechnung des Nettolohns eines Arbeitnehmers aus</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Anzahl Arbeitsstunden und Bruttostundenlohn (in Euro)</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Resultat: Nettolohn (in Euro)</span>
    <span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">=======================================================</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">nettoeinkommen</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>arbeitsstunden stundenlohn<span style="color: #909183;">]</span>
        <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> arbeitsstunden<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> stundenlohn<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
        <span style="color: #909183;">(</span>- <span style="color: #709870;">(</span>bruttoeinkommen arbeitsstunden stundenlohn<span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>einkommensteuer
             <span style="color: #907373;">(</span>bruttoeinkommen arbeitsstunden stundenlohn<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-nettoeinkommen</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 500085/100  <span style="color: #709870;">(</span>nettoeinkommen 1  5001<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 925071/100  <span style="color: #709870;">(</span>nettoeinkommen 1 10001<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 7315036/100 <span style="color: #709870;">(</span>nettoeinkommen 1 100001<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
</div>
</div>

<div id="outline-container-org90ad45b" class="outline-3">
<h3 id="org90ad45b"><span class="section-number-3">1.6</span> Aufgabe (Datenstrukturen)</h3>
<div class="outline-text-3" id="text-1-6">
<p>
Gehen Sie für die Lösung der Aufgabe nach Entwurfsvorschrift III
vor!
</p>

<ol class="org-ol">
<li><p>
Definieren Sie eine Datenstruktur für „Zeitpunkte seit
Mitternacht”, die aus den Komponenten <code>stunden</code>, <code>minuten</code> und
<code>sekunden</code> besteht.
</p>

<p>
Entwickeln Sie eine Funktion <code>zeit-&gt;sekunden</code>, die eine
   Zeitpunkt-seit-Mittnacht-Struktur verarbeitet und die seit
   Mitternacht vergangenen Sekunden berechnet.
</p></li>
</ol>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #006FE0;">use</span> '<span style="color: #6434A3;">clojure.test</span><span style="color: #707183;">)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">die Uhrzeit besteht aus</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- einer Zahl f&#252;r die Stunden</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- einer Zahl f&#252;r die Minuten</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- einer Zahl f&#252;r die Sekunden</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">-&gt;uhrzeit: (number number number -&gt; uhrzeit)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">:uhrzeit-h</span><span style="color: #8D8D84; font-style: italic;"> : (uhrzeit -&gt; number)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">:uhrzeit-m</span><span style="color: #8D8D84; font-style: italic;"> : (uhrzeit -&gt; number)</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">:uhrzeit-s</span><span style="color: #8D8D84; font-style: italic;"> : (uhrzeit -&gt; number))</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">defrecord</span> <span style="color: #6434A3;">uhrzeit</span>
    <span style="color: #7388D6;">[</span>uhrzeit-h uhrzeit-m uhrzeit-s<span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die Sekunden seit Mitternacht</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">zeit-seit-mitternacht</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>u<span style="color: #909183;">]</span>
    <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span>  <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">instance?</span> uhrzeit u<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
     <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
    <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span>* 3600 <span style="color: #907373;">(</span><span style="color: #D0372D;">:uhrzeit-h</span> u<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
       <span style="color: #709870;">(</span>* 60   <span style="color: #907373;">(</span><span style="color: #D0372D;">:uhrzeit-m</span> u<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
       <span style="color: #709870;">(</span><span style="color: #D0372D;">:uhrzeit-s</span> u<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">uhrzeit-test</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>zeit-seit-mitternacht <span style="color: #907373;">(</span>-&gt;uhrzeit 1 2 3<span style="color: #907373;">)</span><span style="color: #709870;">)</span> 3723<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">run-tests</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
<ol class="org-ol">
<li><p>
Definieren Sie geeignete <b>Datenstrukturen</b> für Kreise, die durch
</p>

<ul class="org-ul">
<li>die Koordinaten des Mittelpunkts und</li>
<li>den Radius und</li>
</ul>
<p>
gegeben sind.
</p>

<p>
Schreiben Sie eine Funktion, die prüft, ob ein Punkt
   innerhalb eines Kreises liegt.
</p></li>
</ol>
</div>
</div>

<div id="outline-container-org21aaf23" class="outline-3">
<h3 id="org21aaf23"><span class="section-number-3">1.7</span> Aufgabe (gemischte Daten)</h3>
<div class="outline-text-3" id="text-1-7">
<p>
Ein <i>Mitarbeiter</i> ist entweder
</p>

<ul class="org-ul">
<li>ein <i>Festangestellter</i> oder</li>
<li>ein <i>Werkstudent</i></li>
</ul>

<p>
Ein <i>Festangestellter</i> wird definiert durch
</p>

<ul class="org-ul">
<li>seinen Namen,</li>
<li>sein Grundgehalt,</li>
<li>die im letzten Monat geleisteten Arbeitsstunden.</li>
</ul>

<p>
Ein <i>Werkstudent</i> wird definiert durch
</p>

<ul class="org-ul">
<li>seinen Namen,</li>
<li>seinen Stundenlohn,</li>
<li>die im letzten Monat geleisteten Arbeitsstunden.</li>
</ul>

<p>
Definieren Sie unter Berücksichtigung von Entwurfsvorschrift IV
</p>

<ul class="org-ul">
<li>geeignete Datenstrukturen für <i>Mitarbeiter</i>,</li>
<li>eine Funktionsschablone für Funktionen, die <i>Mitarbeiter</i>
verarbeiten.</li>
</ul>

<p>
Entwickeln auf der Grundlage dieser Schablone eine Funktion, die den
Bruttomonatslohn eines Mitarbeiters berechnet. Bei <i>Festangestellten</i>
berechnet sich der Monatslohn aus dem Grundgehalt zuzüglich
Überstundenentgelt. Überstunden sind die über die monatliche
Sollarbeitszeit (die als globale Konstante definiert wird)
hinausgehenden Arbeitsstunden. Der Stundenlohn pro Überstunde berechnet
sich aus dem Grundgehalt und der monatlichen Sollarbeitszeit plus
\(25\%\). Minderstunden bleiben unberücksichtigt.
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #006FE0;">use</span> '<span style="color: #6434A3;">clojure.test</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Konstanten - monatliche Sollarbeitszeit in Stunden</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">sollstunden</span> 160<span style="color: #707183;">)</span>


<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Ein Festangestellter wird definiert durch</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- seinen Namen</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- sein Grundgehalt,</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- die im letzten Monat geleisteten Arbeitsstunden.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">-&gt;angestellter : string number number -&gt; angestellter</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">:angestellter-name</span><span style="color: #8D8D84; font-style: italic;">    : angestellter -&gt; string</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">:angestellter-gehalt</span><span style="color: #8D8D84; font-style: italic;">  : angestellter -&gt; number</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">:angestellter-stunden</span><span style="color: #8D8D84; font-style: italic;"> : angestellter -&gt; number</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">defrecord</span> <span style="color: #6434A3;">angestellter</span>
    <span style="color: #7388D6;">[</span>angestellter-name angestellter-gehalt angestellter-stunden<span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Ein Werkstudent wird definiert durch</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- seinen Namen,</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- seinen Stundenlohn,</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- die im letzten Monat geleisteten Arbeitsstunden.</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">-&gt;student : string number number -&gt; student</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">:student-name</span><span style="color: #8D8D84; font-style: italic;">    : student -&gt; string</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">:student-lohn</span><span style="color: #8D8D84; font-style: italic;">    : student -&gt; number</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">:student-stunden</span><span style="color: #8D8D84; font-style: italic;"> : student -&gt; number</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">defrecord</span> <span style="color: #6434A3;">student</span>
    <span style="color: #7388D6;">[</span>student-name student-lohn student-stunden<span style="color: #7388D6;">]</span><span style="color: #707183;">)</span>


<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet den Ueberstundenzuschlag eines Angestellten:</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Gehalt pro Ueberstunde = (Gehalt / sollstunden) * 1.25 </span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">ueberstunden = ist stunden - soll stunden</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">zuschlag = ueberstunden * gehalt pro ueberstunde </span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">ueberstunden-zuschlag</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>fa<span style="color: #909183;">]</span>
    <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">instance?</span> angestellter fa<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
     <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">(</span>&gt; <span style="color: #907373;">(</span><span style="color: #D0372D;">:angestellter-stunden</span> fa<span style="color: #907373;">)</span> sollstunden<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>* <span style="color: #907373;">(</span>/ <span style="color: #6276BA;">(</span><span style="color: #D0372D;">:angestellter-gehalt</span> fa<span style="color: #6276BA;">)</span> sollstunden<span style="color: #907373;">)</span> 5/4
         <span style="color: #907373;">(</span>- <span style="color: #6276BA;">(</span><span style="color: #D0372D;">:angestellter-stunden</span> fa<span style="color: #6276BA;">)</span> sollstunden<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
      <span style="color: #D0372D;">:else</span> 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-ueberstundenZuschlag</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>ueberstunden-zuschlag <span style="color: #907373;">(</span>-&gt;angestellter <span style="color: #008000;">"Karl"</span> 2000 170<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>+ 156 1/4<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>ueberstunden-zuschlag <span style="color: #907373;">(</span>-&gt;angestellter <span style="color: #008000;">"Franz"</span> 2000 140<span style="color: #907373;">)</span><span style="color: #709870;">)</span> 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet Bruttomonatslohn eines Angestellten aus:</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Grundgehalt + &#220;berstundenentgelt</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">angestellter-monatslohn</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>a<span style="color: #909183;">]</span>
    <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">instance?</span> angestellter a<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
     <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
    <span style="color: #909183;">(</span>+ <span style="color: #709870;">(</span><span style="color: #D0372D;">:angestellter-gehalt</span> a<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>ueberstunden-zuschlag a<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-angestellter-monatslohn</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>angestellter-monatslohn <span style="color: #907373;">(</span>-&gt;angestellter <span style="color: #008000;">"Meier"</span> 1000 160<span style="color: #907373;">)</span><span style="color: #709870;">)</span> 1000<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>angestellter-monatslohn 
          <span style="color: #907373;">(</span>-&gt;angestellter <span style="color: #008000;">"Mueller"</span> 2000 170<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>+ 2156 1/4<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet Bruttomonatslohn eines Studenten aus:</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Stundenlohn x Arbeitsstunden</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">student-monatslohn</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>st<span style="color: #909183;">]</span>
    <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">instance?</span> student st<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
     <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
    <span style="color: #909183;">(</span>* <span style="color: #709870;">(</span><span style="color: #D0372D;">:student-stunden</span> st<span style="color: #709870;">)</span> <span style="color: #709870;">(</span><span style="color: #D0372D;">:student-lohn</span> st<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-student-monatslohn</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>student-monatslohn <span style="color: #907373;">(</span>-&gt;student <span style="color: #008000;">"Karl"</span> 8 150<span style="color: #907373;">)</span><span style="color: #709870;">)</span> 1200<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>


<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Ein Mitarbeiter ist entweder</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- ein Festangesteller</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- ein Werksstudent</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">mitarbeiter?</span> #<span style="color: #7388D6;">(</span><span style="color: #0000FF;">or</span> <span style="color: #909183;">(</span><span style="color: #006FE0;">instance?</span> angestellter <span style="color: #BA36A5;">%</span><span style="color: #909183;">)</span>
                       <span style="color: #909183;">(</span><span style="color: #006FE0;">instance?</span> student <span style="color: #BA36A5;">%</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet Bruttomonatslohn eines Mitarbeiters</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">monatslohn</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>m<span style="color: #909183;">]</span>
    <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span>mitarbeiter? m<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
     <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">(</span><span style="color: #006FE0;">instance?</span> angestellter m<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>angestellter-monatslohn m<span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span><span style="color: #006FE0;">instance?</span> student m<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>student-monatslohn m<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-monatslohn</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>monatslohn <span style="color: #907373;">(</span>-&gt;angestellter <span style="color: #008000;">"Mueller"</span> 2000 170<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>+ 2156 1/4<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>monatslohn  <span style="color: #907373;">(</span>-&gt;angestellter <span style="color: #008000;">"Hans"</span> 2000 140<span style="color: #907373;">)</span><span style="color: #709870;">)</span> 2000<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>monatslohn  <span style="color: #907373;">(</span>-&gt;student <span style="color: #008000;">"Franz"</span> 10 150<span style="color: #907373;">)</span><span style="color: #709870;">)</span> 1500<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">run-tests</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
</div>
</div>
<div id="outline-container-org240149d" class="outline-3">
<h3 id="org240149d"><span class="section-number-3">1.8</span> Aufgabe (elementare Ausdrücke über Listen)</h3>
<div class="outline-text-3" id="text-1-8">
<p>
Werten Sie die folgenden Funktionsaufrufe aus:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Nr.</th>
<th scope="col" class="org-left">Ausdruck</th>
<th scope="col" class="org-left">Lösung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">a)</td>
<td class="org-left"><code>(first '((A) B C D))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">b)</td>
<td class="org-left"><code>(rest '((A)(B C D)))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">c)</td>
<td class="org-left"><code>(cons '(A B) '(A B))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">d)</td>
<td class="org-left"><code>(cons 'A '())</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">e)</td>
<td class="org-left"><code>(first '(((A))))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">f)</td>
<td class="org-left"><code>(rest '(((A))))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">g)</td>
<td class="org-left"><code>(cons '((A)) empty)</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">h)</td>
<td class="org-left"><code>(= 'X1 'X2)</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">i)</td>
<td class="org-left"><code>(= '(X1) 'X2)</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">j)</td>
<td class="org-left"><code>(= '(X1) '(X2))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">k)</td>
<td class="org-left"><code>(list? 'X1)</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">l)</td>
<td class="org-left"><code>(list? '(X1))</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">m)</td>
<td class="org-left"><code>(list? '())</code></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">n)</td>
<td class="org-left"><code>(list? '(())</code></td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org05fd7b3" class="outline-3">
<h3 id="org05fd7b3"><span class="section-number-3">1.9</span> Aufgabe (listenverarbeitende Funktionen)</h3>
<div class="outline-text-3" id="text-1-9">
<ol class="org-ol">
<li>Die Funktion <code>sum</code> liefere, angewendet auf eine Liste von Zahlen <code>x</code>,
die Summe der Elemente.</li>

<li>Die Funktion <code>prod</code> liefere, angewendet auf eine Liste von Zahlen
<code>x</code>, das Produkt der Elemente.</li>

<li>Die Funktion <code>maximum</code> liefere, angewendet auf eine Liste von Zahlen
<code>x</code>, das Maximum der Elemente.</li>

<li>Die Funktion <code>enthaelt?</code> beantworte, angewendet auf ein Symbol und
eine Liste von Symbolen, die Frage, ob das Symbol in der Liste
enthalten ist oder nicht</li>
</ol>

<div class="org-src-container">
<pre class="src src-clojure">    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die Summe der Elemente einer Zahlenliste  </span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">sum</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lon<span style="color: #909183;">]</span>
        <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? lon<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> lon<span style="color: #709870;">)</span> 0
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span>+ <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> lon<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>sum <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lon<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-sum</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 0 <span style="color: #709870;">(</span>sum <span style="color: #907373;">()</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 12 <span style="color: #709870;">(</span>sum '<span style="color: #907373;">(</span>7 3 2<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet das Produkt der Elemente einer Zahlenliste  </span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">prod</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lon<span style="color: #909183;">]</span>
        <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? lon<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> lon<span style="color: #709870;">)</span> 1
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span>* <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> lon<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>prod <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lon<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-prod</span>
     <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 1  <span style="color: #709870;">(</span>prod <span style="color: #907373;">()</span><span style="color: #709870;">)</span> <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
     <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 60 <span style="color: #709870;">(</span>prod '<span style="color: #907373;">(</span>3 4 5<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Definition einer Datenstruktur fuer nicht-leere</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zahlenlisten (nllvz):</span>
    <span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">Eine nllvz ist entweder</span>
    <span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">1. (cons z ()) mit z ist ein Zahl; oder</span>
    <span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">2. (cons z nl) mit z ist ein Zahl und nl eine nllvz</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet das Maximum der Elemente einer Zahlenliste  </span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">maximum</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lon<span style="color: #909183;">]</span>
        <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? lon<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">rest</span> lon<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">first</span> lon<span style="color: #709870;">)</span>
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">max</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> lon<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>maximum <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lon<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-max</span>
     <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= -1  <span style="color: #709870;">(</span>maximum '<span style="color: #907373;">(</span>-1 -2<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
     <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 5 <span style="color: #709870;">(</span>maximum '<span style="color: #907373;">(</span>3 5 1<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">prueft, ob ein Symbol in einer Liste von Symbolen vorkommt</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">enthaelt?</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>liste symbol<span style="color: #909183;">]</span>
        <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> symbol? liste<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">or</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">true?</span> <span style="color: #BA36A5;">%</span><span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">false?</span> <span style="color: #BA36A5;">%</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> liste<span style="color: #709870;">)</span> <span style="color: #D0372D;">false</span>
          <span style="color: #D0372D;">:else</span>
           <span style="color: #709870;">(</span><span style="color: #0000FF;">cond</span> 
             <span style="color: #907373;">(</span>= <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> liste<span style="color: #6276BA;">)</span> symbol<span style="color: #907373;">)</span> <span style="color: #D0372D;">true</span>
             <span style="color: #D0372D;">:else</span> <span style="color: #907373;">(</span>enthaelt? <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> liste<span style="color: #6276BA;">)</span> symbol<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-enthaelt</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #D0372D;">false</span> <span style="color: #709870;">(</span>enthaelt? <span style="color: #907373;">()</span> 's<span style="color: #709870;">)</span> <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #D0372D;">false</span> <span style="color: #709870;">(</span>enthaelt? '<span style="color: #907373;">(</span>x y z<span style="color: #907373;">)</span> 's<span style="color: #709870;">)</span> <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #D0372D;">true</span> <span style="color: #709870;">(</span>enthaelt? '<span style="color: #907373;">(</span>s y z<span style="color: #907373;">)</span> 's<span style="color: #709870;">)</span> <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #D0372D;">true</span> <span style="color: #709870;">(</span>enthaelt? '<span style="color: #907373;">(</span>x y s z<span style="color: #907373;">)</span> 's<span style="color: #709870;">)</span> <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

      </pre>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgce4bb86" class="outline-3">
<h3 id="orgce4bb86"><span class="section-number-3">1.10</span> Aufgabe (listenverarbeitende Funktionen)</h3>
<div class="outline-text-3" id="text-1-10">
<p>
Schreiben Sie eine Funktion <code>(declist x)</code>, die aus einer Liste <code>x</code> von
Zahlen eine neue Liste berechnet, deren Elemente um 1 kleiner sind, als
die der ursprünglichen Liste:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">x</th>
<th scope="col" class="org-left">(declist x)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">(2 5 7)</td>
<td class="org-left">(1 4 6)</td>
</tr>

<tr>
<td class="org-left">()</td>
<td class="org-left">()</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-clojure">    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nimmt eine Liste von Zahlen und erzeugt eine neue,</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">deren Elemente um 1 kleiner sind, als die der </span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">urspruenglichen Liste</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">declist</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lon<span style="color: #909183;">]</span>
        <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? lon<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> lon<span style="color: #709870;">)</span> <span style="color: #709870;">()</span>
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #907373;">(</span>- <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> lon<span style="color: #6276BA;">)</span> 1<span style="color: #907373;">)</span>
                      <span style="color: #907373;">(</span>declist <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lon<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-declist</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">()</span> <span style="color: #709870;">(</span>declist <span style="color: #907373;">()</span><span style="color: #709870;">)</span> <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">(</span>1 -6 16<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>declist '<span style="color: #907373;">(</span>2 -5 17<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>    
      </pre>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2070baa" class="outline-3">
<h3 id="org2070baa"><span class="section-number-3">1.11</span> Aufgabe (listenverarbeitende Funktionen)</h3>
<div class="outline-text-3" id="text-1-11">
<ol class="org-ol">
<li><p>
Definieren Sie eine Funktion <code>(flatten x)</code>, die als Argument eine
Liste <code>x</code> mit beliebig tief geschachtelten Unterlisten hat und als
Ergebnis eine Liste von Atomen liefern soll mit der Eigenschaft, dass
alle Atome, die in x vorkommen auch in <code>(flatten x)</code> in derselben
Reihenfolge vorkommen:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">x</th>
<th scope="col" class="org-left">(flatten x)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">(A (B C) D)</td>
<td class="org-left">(A B C D)</td>
</tr>

<tr>
<td class="org-left">(((A B) C)(D E))</td>
<td class="org-left">(A B C D E)</td>
</tr>

<tr>
<td class="org-left">((((A))))</td>
<td class="org-left">(A)</td>
</tr>
</tbody>
</table>

<p>
<b>Hinweis:</b> Definieren Sie zuerst in der bekannten Art und Weise
eine rekursive Datenstruktur für geschachtelte Listen. Leiten Sie
daraus eine passende <b>Funktionsschablone</b> ab.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Definition einer beliebig tief geschachtelten Liste</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(btgl) von Atomen:</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine btgl ist</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- ()</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (cons a l) mit a ist ein Atom, l ist eine btgl</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (cons l1 l2) mit l1, l2 sind btgl</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Funktionsschablone:</span>
       <span style="color: #8D8D84; font-style: italic;">;(def f</span>
       <span style="color: #8D8D84; font-style: italic;">;  (fn [l]</span>
       <span style="color: #8D8D84; font-style: italic;">;    (cond</span>
       <span style="color: #8D8D84; font-style: italic;">;      (empty? l) ...</span>
       <span style="color: #8D8D84; font-style: italic;">;      (not (seq? (first l)))</span>
       <span style="color: #8D8D84; font-style: italic;">;       ... (first l) ... (f (rest l)) ...</span>
       <span style="color: #8D8D84; font-style: italic;">;      </span><span style="color: #8D8D84; font-style: italic;">:else</span><span style="color: #8D8D84; font-style: italic;">  ... (f (first l)) ... (f (rest l)) ...)))</span>

       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nimmt eine Liste von Zahlen und erzeugt eine neue,</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">deren Elemente um 1 kleiner sind, als die der </span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">urspruenglichen Liste</span>
       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">flatten</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lst<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">seq?</span> lst<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">not-any?</span> seq?  <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
c           <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
            <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> lst<span style="color: #709870;">)</span> <span style="color: #709870;">()</span>
            <span style="color: #709870;">(</span><span style="color: #006FE0;">not</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">seq?</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> lst<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
              <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> lst<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">flatten</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lst<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">concat</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">flatten</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> lst<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> 
                         <span style="color: #907373;">(</span><span style="color: #006FE0;">flatten</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lst<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-flatten</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">flatten</span> <span style="color: #907373;">()</span><span style="color: #709870;">)</span> <span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">flatten</span> '<span style="color: #907373;">(</span>a <span style="color: #6276BA;">(</span>b <span style="color: #858580;">(</span>c <span style="color: #80A880;">(</span>d<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span>a b c d<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">flatten</span> '<span style="color: #907373;">(</span><span style="color: #6276BA;">(</span><span style="color: #858580;">(</span><span style="color: #80A880;">(</span>a<span style="color: #80A880;">)</span> b<span style="color: #858580;">)</span> c<span style="color: #6276BA;">)</span> d<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span>a b c d<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
             </pre>
</pre>
</div></li>

<li><p>
Schreiben Sie eine Funktion <code>(frequencies x)</code>, die aus einer Liste
<code>x</code> von Atomen eine Liste von zwei-elementigen Listen erzeugt: Dabei
ist das erste Element das Atom aus <code>x</code>, das zweite Element die
Häufigkeit des Auftretens in <code>x</code>. Die Reihenfolge der Strukturen in
der Ergebnisliste ist belanglos.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">x</th>
<th scope="col" class="org-left">(frequencies x)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">(A B A B A C A)</td>
<td class="org-left">((A 4) (B 2) (C 1))</td>
</tr>

<tr>
<td class="org-left">()</td>
<td class="org-left">()</td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datenstrukturdefinitionen:</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Atom-Number-Pair (anp) ist ein</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (cons a (cons n () )) mit a ist Atom und n ist Number</span>
       <span style="color: #8D8D84;">;;</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste von Atomen (loa) ist </span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- () oder</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (cons a l) mit a ist Atom und l ist loa</span>
       <span style="color: #8D8D84;">;;</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Eine Liste von Atom-Number-Pairs (loanp) ist</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- () oder</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (cons a l) mit a ist anp und l ist loanp</span>

       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">atom-number-pair?</span> 
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>ap<span style="color: #909183;">]</span> 
           <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">not</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">seq?</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> ap<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> 
                <span style="color: #709870;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> ap<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">atom?</span> <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>v<span style="color: #909183;">]</span> <span style="color: #909183;">(</span><span style="color: #006FE0;">not</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">seq?</span> v<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">erhoeht die number im ersten atom-mumber-pair um 1</span>
       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">incr-first-number</span> 
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>aloanp<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> atom-number-pair? aloanp<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> atom-number-pair? <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span><span style="color: #0000FF;">let</span>
               <span style="color: #709870;">[</span>firstatom <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> aloanp<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                firstnumber <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> <span style="color: #858580;">(</span><span style="color: #006FE0;">first</span> aloanp<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                rest-anps <span style="color: #907373;">(</span><span style="color: #006FE0;">rest</span> aloanp<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
             <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">list</span> firstatom <span style="color: #6276BA;">(</span>+ firstnumber 1<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> 
                   rest-anps<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-incr-first-number</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>incr-first-number '<span style="color: #907373;">(</span><span style="color: #6276BA;">(</span>a  5<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>b  3<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>c  4<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> 
                '<span style="color: #709870;">(</span><span style="color: #907373;">(</span>a  6<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>b  3<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>c  4<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">prueft, ob das Atom in der Liste vorkommt:</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- falls ja ist die number im entsprechenden pair zu </span>
       <span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">inkrementieren</span>
       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- falls nein ist der Liste ein neues pair "(atom  1)"</span>
       <span style="color: #8D8D84;">;;   </span><span style="color: #8D8D84; font-style: italic;">hinzuzufuegen</span>
       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">addAtom</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>atom aloanp<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> atom-number-pair? aloanp<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> atom-number-pair? <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
             <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> aloanp<span style="color: #709870;">)</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">list</span> atom 1<span style="color: #907373;">)</span> <span style="color: #907373;">()</span> <span style="color: #709870;">)</span>
             <span style="color: #709870;">(</span>= atom <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> aloanp<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> 
               <span style="color: #709870;">(</span>incr-first-number aloanp<span style="color: #709870;">)</span>
             <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> aloanp<span style="color: #907373;">)</span> 
                         <span style="color: #907373;">(</span><span style="color: #808080;">addAtom</span> atom <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> aloanp<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-addAtom</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #808080;">addAtom</span> 'a <span style="color: #907373;">()</span> <span style="color: #709870;">)</span>  '<span style="color: #709870;">(</span><span style="color: #907373;">(</span>a  1<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #808080;">addAtom</span> 'a '<span style="color: #907373;">(</span><span style="color: #6276BA;">(</span>a  1<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>b  1<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span><span style="color: #907373;">(</span>a  2<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>b  1<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #808080;">addAtom</span> 'a '<span style="color: #907373;">(</span><span style="color: #6276BA;">(</span>b  1<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span><span style="color: #907373;">(</span>b  1<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>a  1<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Zweckbestimmung s. Aufgabenblatt</span>
       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">frequencies</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>aloa<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> atom? aloa<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> atom-number-pair? <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
             <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> aloa<span style="color: #709870;">)</span> <span style="color: #709870;">()</span>
             <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #808080;">addAtom</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> aloa<span style="color: #907373;">)</span> 
                            <span style="color: #907373;">(</span><span style="color: #006FE0;">frequencies</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> aloa<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-frequencies</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">frequencies</span> <span style="color: #907373;">()</span><span style="color: #709870;">)</span> <span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">frequencies</span> '<span style="color: #907373;">(</span>a<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span><span style="color: #907373;">(</span>a  1<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
         <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">frequencies</span> '<span style="color: #907373;">(</span><span style="color: #D0372D;">A</span> <span style="color: #D0372D;">B</span> <span style="color: #D0372D;">A</span> <span style="color: #D0372D;">B</span> <span style="color: #D0372D;">A</span> <span style="color: #D0372D;">C</span> <span style="color: #D0372D;">A</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> 
                '<span style="color: #709870;">(</span><span style="color: #907373;">(</span><span style="color: #D0372D;">A</span>  4<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #D0372D;">C</span>  1<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #D0372D;">B</span>  2<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
        </pre>
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org83aa4f3" class="outline-3">
<h3 id="org83aa4f3"><span class="section-number-3">1.12</span> Aufgabe (Datentyp <b>Nat</b>)</h3>
<div class="outline-text-3" id="text-1-12">
<ol class="org-ol">
<li>Schreiben Sie eine Funktion <code>repeat</code>, die eine natürliche Zahl
\(n\in Nat\) (Definition des Datentyps \(Nat\) s. Vorlesung) und ein
Symbol \(s\) als Argumente nimmt und eine Liste mit dem \(n\) -maligen
Auftreten von \(s\) erzeugt.</li>

<li><p>
Schreiben Sie eine Funktion <code>Int-&gt;Nat</code>, die eine beliebige positive
ganze Zahl in eine äquivalentes Element des Datentyps \(Nat\)
verwandelt, z.B.:
</p>

<p>
<code>(Int-&gt;Nat 3) =&gt; (succ (succ (succ zero)))</code>
</p></li>

<li><p>
Schreiben Sie eine Funktion <code>Nat-&gt;Int</code>, die eine natürliche Zahl
\(n\in Nat\) in eine normale Clojure-Number verwandelt, z.B.:
</p>

<p>
<code>(Nat-&gt;Int (succ (succ (succ zero)))) =&gt; 3</code>
</p></li>

<li><p>
Schreiben Sie eine Funktion
</p>

<p>
<code>;; times: Nat Nat -&gt; Nat</code><br />
, die zwei natürliche Zahlen multipliziert.
</p></li>
</ol>
<div class="org-src-container">
<pre class="src src-clojure">    <span style="color: #707183;">(</span><span style="color: #0000FF;">ns</span> <span style="color: #6434A3;">nat</span><span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #006FE0;">use</span> '<span style="color: #6434A3;">clojure.test</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">zero</span> 'zero<span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">succ: Nat -&gt; Nat</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">succ</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>n<span style="color: #909183;">]</span> <span style="color: #909183;">(</span><span style="color: #006FE0;">list</span> 'succ n<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-succ</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>succ zero<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>succ zero<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>=  <span style="color: #709870;">(</span>succ <span style="color: #907373;">(</span>succ zero<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>succ <span style="color: #907373;">(</span>succ zero<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">prueft, ob ihr Argument zero ist.</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">=zero?: Nat -&gt; boolean</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">=zero?</span> 
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>n<span style="color: #909183;">]</span>
        <span style="color: #909183;">(</span>= n zero<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> 

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-=zero?</span> 
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>=  <span style="color: #709870;">(</span>=zero? zero<span style="color: #709870;">)</span> <span style="color: #D0372D;">true</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>=  <span style="color: #709870;">(</span>=zero? <span style="color: #907373;">(</span>succ zero<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #D0372D;">false</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">liefert den Term des Vorgaengers ihres Arguments</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">pred: Nat -&gt; Nat</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">pred</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>n<span style="color: #909183;">]</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span>=zero? n<span style="color: #709870;">)</span> <span style="color: #709870;">(</span><span style="color: #0000FF;">throw</span>  <span style="color: #907373;">(</span><span style="color: #6434A3;">Exception.</span> <span style="color: #008000;">"zero hat keinen Vorgaenger"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
          <span style="color: #D0372D;">:else</span>
           <span style="color: #709870;">(</span><span style="color: #006FE0;">first</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">rest</span> n<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-pred</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>=  <span style="color: #709870;">(</span>pred <span style="color: #907373;">(</span>succ zero<span style="color: #907373;">)</span><span style="color: #709870;">)</span> zero<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>=  <span style="color: #709870;">(</span>pred <span style="color: #907373;">(</span>succ <span style="color: #6276BA;">(</span>succ zero<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>succ zero<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>thrown? <span style="color: #6434A3;">Exception</span> <span style="color: #709870;">(</span>pred zero<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die Summe ihrer Argumente</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">plus: Nat Nat -&gt; Nat</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">plus</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>n m<span style="color: #909183;">]</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span> 
         <span style="color: #709870;">(</span>=zero? n<span style="color: #709870;">)</span> m
         <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span>succ <span style="color: #907373;">(</span>plus <span style="color: #6276BA;">(</span>pred n<span style="color: #6276BA;">)</span> m<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-plus</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>plus zero <span style="color: #907373;">(</span>succ zero<span style="color: #907373;">)</span><span style="color: #709870;">)</span>  <span style="color: #709870;">(</span>succ zero<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>plus <span style="color: #907373;">(</span>succ zero<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>succ zero<span style="color: #907373;">)</span><span style="color: #709870;">)</span> 
                  <span style="color: #709870;">(</span>succ <span style="color: #907373;">(</span>succ zero<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>plus <span style="color: #907373;">(</span>succ zero<span style="color: #907373;">)</span>
                   <span style="color: #907373;">(</span>plus <span style="color: #6276BA;">(</span>succ zero<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>succ zero<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
             <span style="color: #709870;">(</span>succ <span style="color: #907373;">(</span>succ <span style="color: #6276BA;">(</span>succ zero<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">zaehlt die Anzahl der Elemente ihres Arguments</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">countElements: (list-of any) -&gt; Nat</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">countElements</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lst<span style="color: #909183;">]</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> lst<span style="color: #709870;">)</span> zero
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span>succ <span style="color: #907373;">(</span><span style="color: #808080;">countElements</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lst<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> 

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-countElements</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>=  <span style="color: #709870;">(</span><span style="color: #808080;">countElements</span> <span style="color: #907373;">()</span> <span style="color: #709870;">)</span> zero<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>=  <span style="color: #709870;">(</span><span style="color: #808080;">countElements</span> '<span style="color: #907373;">(</span>19 27 36<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>succ <span style="color: #907373;">(</span>succ <span style="color: #6276BA;">(</span>succ zero<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">repeat erzeugt eine Liste mit dem n-maligen Auftreten von s</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">repeat: Nat symbol -&gt; (list-of symbol)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">repeat</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>n s<span style="color: #909183;">]</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
         <span style="color: #709870;">(</span>=zero? n<span style="color: #709870;">)</span> <span style="color: #709870;">()</span>
         <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> s <span style="color: #907373;">(</span><span style="color: #006FE0;">repeat</span> <span style="color: #6276BA;">(</span>pred n<span style="color: #6276BA;">)</span> s<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-repeat</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">repeat</span> <span style="color: #907373;">(</span>succ <span style="color: #6276BA;">(</span>succ zero<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> 'karl<span style="color: #709870;">)</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">list</span> 'karl 'karl<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">repeat</span> <span style="color: #907373;">(</span>succ zero<span style="color: #907373;">)</span> 'rosa<span style="color: #709870;">)</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">list</span> 'rosa<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">repeat</span> zero 'clara<span style="color: #709870;">)</span> <span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">int-&gt;nat verwandelt eine beliebige positive ganze Zahl</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">in eine aequivalentes Element des Datentyps Nat </span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">int-&gt;nat: Number -&gt; Nat</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">int-&gt;nat</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>int<span style="color: #909183;">]</span>
         <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span>= int 0<span style="color: #709870;">)</span> zero
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span>succ <span style="color: #907373;">(</span>int-&gt;nat <span style="color: #6276BA;">(</span>- int 1<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-int-&gt;nat</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>int-&gt;nat 0<span style="color: #709870;">)</span> zero<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>int-&gt;nat 3<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>succ <span style="color: #907373;">(</span>succ <span style="color: #6276BA;">(</span>succ zero<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>


    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nat-&gt;int, wandelt eine natuerliche Zahl aus Nat in eine</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">normale Clojure-Number</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nat-&gt;int: Nat -&gt; Number</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">nat-&gt;int</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>n<span style="color: #909183;">]</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
         <span style="color: #709870;">(</span>=zero? n<span style="color: #709870;">)</span> 0
         <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span>+ 1 <span style="color: #907373;">(</span>nat-&gt;int <span style="color: #6276BA;">(</span>pred n<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-nat-&gt;int</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>nat-&gt;int zero<span style="color: #709870;">)</span> 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>nat-&gt;int <span style="color: #907373;">(</span>succ <span style="color: #6276BA;">(</span>succ <span style="color: #858580;">(</span>succ zero<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> 3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>


    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Multiplikation von zwei Nat-Zahlen aus Nat</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">times: Nat Nat -&gt; Nat</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Axiome</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">n,m aus Nat</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">1. times(0,m) = 0</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">2. times(n,m) = plus(times(pred(n),m),m)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">times</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>f1 f2<span style="color: #909183;">]</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
         <span style="color: #709870;">(</span>=zero? f1<span style="color: #709870;">)</span> zero
         <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span>plus <span style="color: #907373;">(</span>times <span style="color: #6276BA;">(</span>pred f1<span style="color: #6276BA;">)</span> f2<span style="color: #907373;">)</span> f2<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-times</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>times zero zero<span style="color: #709870;">)</span> zero<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>times zero <span style="color: #907373;">(</span>succ zero<span style="color: #907373;">)</span><span style="color: #709870;">)</span> zero<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>times <span style="color: #907373;">(</span>succ <span style="color: #6276BA;">(</span>succ zero<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> <span style="color: #907373;">(</span>succ <span style="color: #6276BA;">(</span>succ zero<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>succ <span style="color: #907373;">(</span>succ <span style="color: #6276BA;">(</span>succ <span style="color: #858580;">(</span>succ zero<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">run-tests</span><span style="color: #707183;">)</span>
          </pre>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfd22833" class="outline-3">
<h3 id="orgfd22833"><span class="section-number-3">1.13</span> Aufgabe (Symbolische Differentiation)</h3>
<div class="outline-text-3" id="text-1-13">
<p>
Es sollen Ausdrücke abgeleitet werden, die nur aus Konstanten, Variablen
und den Operationen \(+\) und \(\cdot\) bestehen.
</p>

<p>
Sei \(D_x\) die partielle Ableitung einer Funktion \(f\) nach \(x\), dann
gelten folgende Regeln:
</p>

<ul class="org-ul">
<li>\(D_x(x) = 1\)</li>

<li>\(D_x(y) = 0\), \(y\neq x\), sei \(y\) eine Konstante oder Variable</li>

<li>\(D_x(e_1 + e_2) = D_x(e_1)+D_x(e_2)\) (Summenregel)</li>

<li>\(D_x(e_1\cdot e_2) = e_1\cdot D_x(e_2) + e_2\cdot D_x(e_1)\)
(Produktregel)</li>
</ul>

<p>
Repräsentation der Formeln:
</p>

<ul class="org-ul">
<li>Konstante: numerisches Atom</li>

<li>Variable: symbolisches Atom</li>

<li>\(e_1 + e_2\): (ADD \(e_1\) \(e_2\))</li>

<li>\(e_1 \cdot e_2\): (MUL \(e_1\) \(e_2\))</li>
</ul>

<p>
<b>Anwendungsbeispiele:</b>
</p>

<p>
Der Ausdruck <code>(diff '(add x x) x)</code> liefere '<code>(add 1 1)</code>
</p>

<p>
oder <code>(diff '(mul x x) 'x)</code> liefere '<code>(add (mul x 1) (mul 1 x))</code>.
</p>

<p>
<b>Hinweise</b>:
</p>

<ul class="org-ul">
<li>Definieren Sie zur Erzeugung von Formeln geeignete Hilfsfunktionen!</li>

<li>Wenn eine Formel nicht korrekt aufgebaut ist, kann das Symbol
'<code>ERROR</code> zurückgeliefert werden, das möglicherweise in einem
korrekten Teil der Formel eingeschachtelt erscheint.</li>

<li>Machen Sie ausgiebig von lokalen Definitionen Gebrauch.</li>
</ul>

<div class="org-src-container">
<pre class="src src-clojure">    <span style="color: #707183;">(</span><span style="color: #0000FF;">ns</span> <span style="color: #6434A3;">diff-mit-vereinfachung2</span><span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #006FE0;">use</span> '<span style="color: #6434A3;">clojure.test</span><span style="color: #707183;">)</span>
    <span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Aufgabe 16  (mit Vereinfachung der abgeleiteten Ausdruecke);;</span>
    <span style="color: #8D8D84;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
    <span style="color: #8D8D84; font-style: italic;">;</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Datenstrukturdefinition fuer Formeln:</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- numerisches Atom oder</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- symbolisches Atom oder</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (add e1 e2) mit e1, e2 sind Formeln, oder</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">- (mul e1 e2) mit e1, e2 sind Formeln</span>

    <span style="color: #8D8D84; font-style: italic;">;Hilfsdefinitionen</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">addop</span> 'add<span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">mulop</span> 'mul<span style="color: #707183;">)</span>

    <span style="color: #8D8D84; font-style: italic;">;ein paar Variablen</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">x</span> 'x<span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">y</span> 'y<span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">z</span> 'z<span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">add: exp exp -&gt; exp</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nimmt primitive Vereinfachungen einer Summenformel vor; </span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">eine Summenformel vereinfacht sich quasi selbst</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">add</span> 
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span> 
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span>= x 0<span style="color: #709870;">)</span> y
          <span style="color: #709870;">(</span>= y 0<span style="color: #709870;">)</span> x
          <span style="color: #709870;">(</span><span style="color: #0000FF;">and</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> x<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> y<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>+ x y<span style="color: #709870;">)</span> 
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">list</span> 'add x y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">mul: exp exp -&gt; exp</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nimmt primitive Vereinfachungen einer Produktformel vor; </span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">eine Produktformel vereinfacht sich quasi selbst</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">mul</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span> 
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #709870;">(</span><span style="color: #0000FF;">or</span> <span style="color: #907373;">(</span>= x 0<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>= y 0<span style="color: #907373;">)</span><span style="color: #709870;">)</span> 0
          <span style="color: #709870;">(</span>= y 1<span style="color: #709870;">)</span> x
          <span style="color: #709870;">(</span>= x 1<span style="color: #709870;">)</span> y
          <span style="color: #709870;">(</span><span style="color: #0000FF;">and</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> x<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> y<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>* x y<span style="color: #709870;">)</span>
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">list</span> 'mul x y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">complex-formula?</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>liste<span style="color: #909183;">]</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">and</span> <span style="color: #709870;">(</span>= <span style="color: #907373;">(</span><span style="color: #006FE0;">count</span> liste<span style="color: #907373;">)</span> 3<span style="color: #709870;">)</span>
             <span style="color: #709870;">(</span><span style="color: #0000FF;">or</span> <span style="color: #907373;">(</span>= <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> liste<span style="color: #6276BA;">)</span> addop<span style="color: #907373;">)</span>
                 <span style="color: #907373;">(</span>= <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> liste<span style="color: #6276BA;">)</span> mulop<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">formula?</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>form<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">or</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">number?</span> form<span style="color: #709870;">)</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">symbol?</span> form<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>complex-formula? form<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>


    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">diff</span> 
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>exp var<span style="color: #909183;">]</span>
        <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span>formula? exp<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">symbol?</span> var<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span>formula? <span style="color: #BA36A5;">%</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">let</span>
            <span style="color: #709870;">[</span>operand-1 <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>e<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> <span style="color: #858580;">(</span><span style="color: #006FE0;">rest</span> exp<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
             operand-2 <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>e<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> <span style="color: #858580;">(</span><span style="color: #006FE0;">rest</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">rest</span> exp<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
             variable? <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">symbol?</span> x<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
             same-variable? <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>v1 v2<span style="color: #6276BA;">]</span>
                              <span style="color: #6276BA;">(</span><span style="color: #0000FF;">and</span> <span style="color: #858580;">(</span>variable? v1<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>variable? v2<span style="color: #858580;">)</span> 
                                   <span style="color: #858580;">(</span>= v1 v2<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
             sum? <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>formula<span style="color: #6276BA;">]</span>
                    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">prueft, ob formula eine Summe ist</span>
                    <span style="color: #6276BA;">(</span><span style="color: #0000FF;">and</span> <span style="color: #858580;">(</span>complex-formula? formula<span style="color: #858580;">)</span> 
                         <span style="color: #858580;">(</span>= <span style="color: #80A880;">(</span><span style="color: #006FE0;">first</span> formula<span style="color: #80A880;">)</span> addop<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
             prod? <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>formula<span style="color: #6276BA;">]</span>
                     <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">prueft, ob formula ein Produkt ist</span>
                     <span style="color: #6276BA;">(</span><span style="color: #0000FF;">and</span> <span style="color: #858580;">(</span>complex-formula? formula<span style="color: #858580;">)</span> 
                          <span style="color: #858580;">(</span>= <span style="color: #80A880;">(</span><span style="color: #006FE0;">first</span> formula<span style="color: #80A880;">)</span> mulop<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
          <span style="color: #709870;">(</span><span style="color: #0000FF;">cond</span>
           <span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> exp<span style="color: #907373;">)</span> 0
           <span style="color: #907373;">(</span>variable? exp<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #0000FF;">if</span> <span style="color: #6276BA;">(</span>same-variable? exp var<span style="color: #6276BA;">)</span> 1 0<span style="color: #907373;">)</span>
           <span style="color: #907373;">(</span>sum? exp<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>add <span style="color: #6276BA;">(</span>diff <span style="color: #858580;">(</span>operand-1 exp<span style="color: #858580;">)</span> var<span style="color: #6276BA;">)</span>
                           <span style="color: #6276BA;">(</span>diff <span style="color: #858580;">(</span>operand-2 exp<span style="color: #858580;">)</span> var<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
           <span style="color: #907373;">(</span>prod? exp<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>add
                        <span style="color: #6276BA;">(</span>mul <span style="color: #858580;">(</span>operand-1 exp<span style="color: #858580;">)</span>
                              <span style="color: #858580;">(</span>diff <span style="color: #80A880;">(</span>operand-2 exp<span style="color: #80A880;">)</span> var<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                        <span style="color: #6276BA;">(</span>mul <span style="color: #858580;">(</span>diff <span style="color: #80A880;">(</span>operand-1 exp<span style="color: #80A880;">)</span> var<span style="color: #858580;">)</span>
                              <span style="color: #858580;">(</span>operand-2 exp<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
           <span style="color: #D0372D;">:else</span> <span style="color: #907373;">(</span><span style="color: #0000FF;">throw</span> <span style="color: #6276BA;">(</span><span style="color: #6434A3;">Exception.</span> <span style="color: #008000;">"unknown expression type"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Tests</span>
    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-diff</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>diff 1 x<span style="color: #709870;">)</span> 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>diff x x<span style="color: #709870;">)</span> 1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>diff y x<span style="color: #709870;">)</span> 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>diff <span style="color: #907373;">(</span>add x x<span style="color: #907373;">)</span> x<span style="color: #709870;">)</span> 2<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>diff <span style="color: #907373;">(</span>mul x x<span style="color: #907373;">)</span> 'x<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>add x x<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">run-tests</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc6a8baf" class="outline-3">
<h3 id="orgc6a8baf"><span class="section-number-3">1.14</span> Aufgabe (Auswertung von Ausdrücken)</h3>
<div class="outline-text-3" id="text-1-14">
<p>
Werten Sie die folgenden Ausdrücke Schritt für Schritt aus:
</p>

<ol class="org-ol">
<li><p>
<code>(+ (* ( / 12 8) 2/3 ) (- 20 (sqrt 4)))</code>
</p>

<pre class="example">
          (+ (* (/ 12 8) 2/3) (- 20 (sqrt 4)))
          = (+ (* 3/2 2/3) (- 20 (sqrt 4)))
          = (+ 1 (- 20 (sqrt 4)))
          = (+ 1 (- 20 2))
          = (+ 1 18)
          = 19                       
</pre></li>
<li><p>
 
</p>

<pre class="example">
              (cond
                 (= 0 0 ) false
                 (&gt; 0 1 ) (= 'a 'a)
                 :else ( = (/ 1 0 ) 9))
</pre>

<pre class="example">
          (cond
            (= 0 0) false
            (&gt; 0 1) (= 'a 'a)
            :else (= (/ 1 0) 9))
          = 
          (cond 
            true false
            (&gt; 0 1) (? 'a 'a)
            :else (= (/ 1 0) 9))
          =
          false
</pre></li>
<li><p>
 
</p>

<pre class="example">
              (cond 
                 (= 2 0) false
                 (&gt; 2 1) (= 'a 'a )
                 :else (= ( / 1 2) 9))
</pre>

<pre class="example">
          (cond
            (= 2 0) false
            (&gt; 2 1) (= 'a 'a)
            :else (= (/ 1 2) 9))
          =
          (cond 
            false false
            (&gt; 2 1) (= 'a 'a)
            :else (= (/ 1 2) 9))
          =
          (cond  
            (&gt; 2 1) (= 'a 'a)
            :else (= (/ 1 2) 9)])
          =
          (cond  
            true (= 'a 'a)
            :else (= (/ 1 2) 9))
          =
          (= 'a 'a)
          =
          true       
</pre></li>
</ol>
</div>
</div>
<div id="outline-container-org83f3590" class="outline-3">
<h3 id="org83f3590"><span class="section-number-3">1.15</span> Aufgabe (Auswertung von Ausdrücken)</h3>
<div class="outline-text-3" id="text-1-15">
<p>
Gegeben sei die folgende Funktionsdefinition:
</p>

<pre class="example">
           ;; f:  number number -&gt; number
           (def f
              (fn [x y]
                  (+ (* 3 x) (* y y))))
</pre>

<p>
Werten Sie die folgenden Ausdrücke Schritt für Schritt aus:
</p>

<ol class="org-ol">
<li><p>
<code>(+ (f 1 2) (f 2 1))</code>
</p>

<pre class="example">
              (+ (f 1 2) (f 2 1))
              = (+ ((fn [x y) (+ (* 3 x) (* y y))) 1 2)
                   ((fn [x y) (+ (* 3 x) (* y y))) 2 1))
              = (+ (+ (* 3 1) (* 2 2)) 
                   (+ (* 3 2) (* 1 1)))
              = (+ (+ 3 4) (+ 6 1))
              = (+ 7 7)
              = 14
</pre></li>
<li><p>
<code>(f 1 (* 2 3))</code>
</p>

<pre class="example">
              (f 1 (* 2 3))
              = ((fn [x y) (+ (* 3 x) (* y y))) 1 (* 2 3))
              = ((fn [x y) (+ (* 3 x) (* y y))) 1 6)
              = (+ (* 3 1) (* 6 6))
              = (+ 3 36)
              = 39        
</pre></li>
<li><p>
<code>(f (f 1 (* 2 3)) 19)</code>
</p>

<pre class="example">
              (f (f 1 (* 2 3)) 19)
              = ((fn [x y) (+ (* 3 x) (* y y))) (f 1 (* 2 3)) 19)
              = ((fn [x y) (+ (* 3 x) (* y y))) 
                   ((fn [x y) (+ (* 3 x) (* y y))) 1 6) 19)
              = ((fn [x y) (+ (* 3 x) (* y y))) 
                   (+ (* 3 1) (* 6 6)) 19)
              = ((fn [x y) (+ (* 3 x) (* y y))) (+ 3 36) 19)
              = ((fn [x y) (+ (* 3 x) (* y y))) 39 19)
              = (+ (* 3 39) (* 19 19))
              = (+ 117 361)
              = 478        
</pre></li>
</ol>
</div>
</div>
<div id="outline-container-org49f680c" class="outline-3">
<h3 id="org49f680c"><span class="section-number-3">1.16</span> Aufgabe (rekursive Induktion)</h3>
<div class="outline-text-3" id="text-1-16">
<p>
Gegeben sei folgende Clojure-Funktion
</p>

<pre class="example">
        (def f
          (fn [n]
            (cond
              (= n 0) 0
              :else (+ (f (- n 1))
                       (/ 1 (* n (+ n 1)))))))
</pre>

<p>
Zeigen Sie, dass der Aufruf <code>(f n)</code> die Zahl \[f(n)=\frac{n}{n+1}\]
berechnet.
</p>

<dl class="org-dl">
<dt>Verankerung:</dt><dd><p>
Der Aufruf <code>(f 0)</code> besitzt Rekursionstiefe 0 und
liefert nach Ersetzungsmodell:
</p>

<pre class="example">
       (f 0)
          =  (cond
                (= 0 0) 0
                :else (+ (f (- 0 1))
                         (/ 1 (* 0 (+ 0 1)))))
          = (cond
                true 0
                :else (+ (f (- 0 1))
                         (/ 1 (* 0 (+ 0 1)))))
          = 0
          \(= \frac{0}{0+1}\)
</pre></dd>

<dt>Induktionsannahme:</dt><dd>Die Behauptung gilt für Rekursionstiefe
\(k = n\), d.h. es gilt \[(f\ n) = \frac{n}{n+1}\].</dd>

<dt>Induktionsschluss</dt><dd><p>
Zu beweisen für \(n\in 
      \textsl{\textbf{N}}\): Die Behauptung gilt auch für einen Aufruf
mit Rekursionstiefe \(n+1\)
\[(f\ m) = \frac{m}{m+1} = \frac{n+1}{n+2} \textrm{ mit } m = n + 
      1\]
</p>

<pre class="example">
          (f m)
          =  (cond
                (= m 0) 0
                :else (+ (f (- m 1))
                         (/ 1 (* m (+ m 1)))))
</pre>

<p>
Da \(m\) eine Zahl größer als \(0\) ist, liefert die Auswertung weiter:
</p>

<pre class="example">
          =  (+ (f (- m 1)) (/ 1 (* m (+ m 1))))
</pre>

<p>
Zwischenschritte:
</p>

<p>
$(- m 1) \(= m-1 = (n + 1) -1 = n\)
</p>

<p>
Sei \(z\) = <code>(/ 1 (* m (+ m 1)))</code>
\[= \frac{1}{m\cdot (m+1)} = \frac{1}{(n+1)\cdot (n+2)}\] Die
Auswertung von <code>(f m)</code> liefert also <code>(+ (f n) z)</code>.
</p>

<p>
Nach Induktionsannahme liefert <code>(f n)</code> \(\frac{n}{n+1}\), also folgt:
</p>

<p>
\[\begin{aligned}
      \frac{n}{n+1} + \frac{1}{(n+1)\cdot (n+2)} & = & \frac{n\cdot 
      (n+2)+1}{(n+1)\cdot (n+2)}  \\
       & = & \frac{n^{2} + 2n + 1}{(n+1)\cdot (n+2)}  \\
       & = & \frac{(n+1)^{2}}{(n+1)\cdot (n+2)}  \\
       & = & \frac{n+1}{n+2}\end{aligned}\]
</p></dd>
</dl>
</div>
</div>

<div id="outline-container-org7959f8e" class="outline-3">
<h3 id="org7959f8e"><span class="section-number-3">1.17</span> Aufgabe (Verarbeitung von zwei Listen)</h3>
<div class="outline-text-3" id="text-1-17">
<p>
Die in den folgenden Aufgaben zu entwickelnden Funktionen haben alle 2
Listen-Parameter. Lösen Sie diese Aufgaben unter Anwendung von
Entwurfsvorschrift V. Überlegen Sie dabei, ob für die Erstellung der
Funktionsschablone der Zugriff auf das erste Element und die Restliste
hinsichtlich des ersten, des zweiten oder beider Parameter vorgenommen
werden muss.
</p>

<ol class="org-ol">
<li>Schreiben Sie ein Funktion <code>concatenate</code>, die zwei Listen von
Symbolen aneinander hängt. Beispiel:
= (concatenate ’(a b c) ’(d e f)) <code>&gt; ’(a b c d e f)</code></li>

<li>Schreiben Sie eine Funktion <code>mult-2-num-lists</code>, die zwei gleich lange
Listen mit Zahlen zu einer Liste verarbeitet, die die Produkte der
korrespondierenden Elemente der Argumentlisten enthält. Beispiel:
<code>(mult-2-num-lists ’(2 3 4) ’(7 8 9)) =&gt; ’(14 24 36)</code></li>

<li>Entwickeln Sie eine Funktion <code>merge</code>, die 2 Listen von Zahlen
verarbeitet, die aufsteigend sortiert sind. Sie liefert eine
sortierte Liste von Zahlen, die alle Zahlen aus den beiden
Argumentlisten enthält. Wenn Zahlen in den Argumentliste mehrfach
vorkommen, sollen Sie auch in der Ergebnisliste entsprechend oft
auftauchen. Beispiel:
=(merge ’(2 5 7) ’(1 3 5 9)) =&gt; ’(1 2 3 5 5 7 9) =</li>
</ol>

<div class="org-src-container">
<pre class="src src-clojure">    <span style="color: #707183;">(</span><span style="color: #0000FF;">ns</span> <span style="color: #6434A3;">zwei</span>Listen<span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #006FE0;">use</span> '<span style="color: #6434A3;">clojure.test</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">haengt zwei Listen von Symbolen aneinander</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">concat</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lvs1 lvs2<span style="color: #909183;">]</span>
        <span style="color: #008000;">\{</span><span style="color: #D0372D;">:pre</span> <span style="color: #909183;">[</span><span style="color: #709870;">(</span><span style="color: #006FE0;">every?</span> symbol? lvs1<span style="color: #709870;">)</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">every?</span> symbol? lvs2<span style="color: #709870;">)</span><span style="color: #909183;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #909183;">[</span><span style="color: #709870;">(</span><span style="color: #006FE0;">every?</span> symbol? <span style="color: #BA36A5;">%</span><span style="color: #709870;">)</span><span style="color: #909183;">]</span><span style="color: #008000;">\}</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span> 
          <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> lvs1<span style="color: #709870;">)</span> lvs2
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> lvs1<span style="color: #907373;">)</span>  
                      <span style="color: #907373;">(</span><span style="color: #006FE0;">concat</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lvs1<span style="color: #6276BA;">)</span> lvs2<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-concat</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">concat</span> '<span style="color: #907373;">()</span> '<span style="color: #907373;">()</span><span style="color: #709870;">)</span> '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">concat</span> '<span style="color: #907373;">(</span>a b c<span style="color: #907373;">)</span> '<span style="color: #907373;">()</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span>a b c<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">concat</span> '<span style="color: #907373;">()</span> '<span style="color: #907373;">(</span>a b c<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span>a b c<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">concat</span> '<span style="color: #907373;">(</span>a b c<span style="color: #907373;">)</span> '<span style="color: #907373;">(</span>x y z<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span>a b c x y z<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">multipliziert korrespondierte Elemente von 2 Zahlenlisten</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">mult-2-num-lists</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lvz1 lvz2<span style="color: #909183;">]</span>
        <span style="color: #008000;">\{</span><span style="color: #D0372D;">:pre</span> <span style="color: #909183;">[</span><span style="color: #709870;">(</span><span style="color: #006FE0;">every?</span> number? lvz1<span style="color: #709870;">)</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">every?</span> number? lvz2<span style="color: #709870;">)</span><span style="color: #909183;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #909183;">[</span><span style="color: #709870;">(</span><span style="color: #006FE0;">every?</span> number? <span style="color: #BA36A5;">%</span><span style="color: #709870;">)</span><span style="color: #909183;">]</span><span style="color: #008000;">\}</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span> 
          <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> lvz1<span style="color: #709870;">)</span> '<span style="color: #709870;">()</span>
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #907373;">(</span>* <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> lvz1<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> lvz2<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> 
                      <span style="color: #907373;">(</span>mult-2-num-lists <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lvz1<span style="color: #6276BA;">)</span>
                                        <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lvz2<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-mult-w-num-lists</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>mult-2-num-lists '<span style="color: #907373;">()</span> '<span style="color: #907373;">()</span><span style="color: #709870;">)</span> '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>mult-2-num-lists '<span style="color: #907373;">(</span>2 3 4<span style="color: #907373;">)</span> '<span style="color: #907373;">(</span>5 6 7<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span>10 18 28<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nimmt zwei aufsteigend sortierte Zahlenlisten und</span>
    <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">mischt sie zu einer sortierte Zahlenliste</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">merge</span>
      <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lvz1 lvz2<span style="color: #909183;">]</span>
        <span style="color: #008000;">\{</span><span style="color: #D0372D;">:pre</span> <span style="color: #909183;">[</span><span style="color: #709870;">(</span><span style="color: #006FE0;">every?</span> number? lvz1<span style="color: #709870;">)</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">every?</span> number? lvz2<span style="color: #709870;">)</span><span style="color: #909183;">]</span>
         <span style="color: #D0372D;">:post</span> <span style="color: #909183;">[</span><span style="color: #709870;">(</span><span style="color: #006FE0;">every?</span> number? <span style="color: #BA36A5;">%</span><span style="color: #709870;">)</span><span style="color: #909183;">]</span><span style="color: #008000;">\}</span>
        <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span> 
          <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> lvz1<span style="color: #709870;">)</span> lvz2
          <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> lvz2<span style="color: #709870;">)</span> lvz1
          <span style="color: #709870;">(</span>&lt; <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> lvz1<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> lvz2<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
          <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> lvz1<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">merge</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lvz1<span style="color: #6276BA;">)</span> lvz2<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
          <span style="color: #D0372D;">:else</span>
          <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> lvz2<span style="color: #907373;">)</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">merge</span> lvz1 <span style="color: #6276BA;">(</span><span style="color: #006FE0;">rest</span> lvz2<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-merge</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">merge</span> '<span style="color: #907373;">()</span> '<span style="color: #907373;">()</span><span style="color: #709870;">)</span> '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">merge</span> '<span style="color: #907373;">(</span> 2 5 7<span style="color: #907373;">)</span> '<span style="color: #907373;">()</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span> 2 5 7<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">merge</span> '<span style="color: #907373;">()</span> '<span style="color: #907373;">(</span> 2 5 7<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span> 2 5 7<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">merge</span> '<span style="color: #907373;">(</span> 2 5 7<span style="color: #907373;">)</span> '<span style="color: #907373;">(</span> 1 5 6<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span>1 2 5 5 6 7<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
      <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span><span style="color: #006FE0;">merge</span> '<span style="color: #907373;">(</span> 2 5 7<span style="color: #907373;">)</span> '<span style="color: #907373;">(</span> 1 1 5 6<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span>1 1 2 5 5 6 7<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #006FE0;">run-tests</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdc49a35" class="outline-3">
<h3 id="orgdc49a35"><span class="section-number-3">1.18</span> Aufgabe (<i>optional</i>)</h3>
<div class="outline-text-3" id="text-1-18">
<p>
Entwerfen Sie einen Satz von Funktionen für die Mengenoperationen
VEREINIGUNG, DURCHSCHNITT, DIFFERENZ, wobei Mengen als Listen von Atomen
ohne Wiederholungen repräsentiert werden sollen.
</p>
</div>
</div>

<div id="outline-container-orge979618" class="outline-3">
<h3 id="orge979618"><span class="section-number-3">1.19</span> Aufgabe (Anwendung von <code>map</code>, <code>filter</code> und <code>reduce</code>)</h3>
<div class="outline-text-3" id="text-1-19">
<p>
Implementieren Sie folgende Funktionen unter Nutzung der Funktionen
<code>filter</code>, <code>reduce</code> und <code>map</code> aus dem Skript (Diese finden Sie in moodle
im Themenblock Beispiele.):
</p>

<ol class="org-ol">
<li><p>
Eine Funktion, die zu allen Zahlen einer Liste jeweils 42 addiert.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">plus42</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? lvz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span><span style="color: #006FE0;">map</span> lvz <span style="color: #709870;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #907373;">[</span>x<span style="color: #907373;">]</span> <span style="color: #907373;">(</span>+ x 42<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
         
       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-plus42</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">()</span> <span style="color: #709870;">(</span>plus42 '<span style="color: #907373;">()</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">(</span>42<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>plus42 '<span style="color: #907373;">(</span>0<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">(</span>30 49 100<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>plus42 '<span style="color: #907373;">(</span>-12 7 58<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
<li><p>
Eine Funktion, die sich wie a) verhält, aber nur die geraden Zahlen
zurückgibt.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">gerade-zahlen</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? lvz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span><span style="color: #006FE0;">filter</span> even? <span style="color: #709870;">(</span>plus42 lvz<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-gerade-zahlen</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">()</span> <span style="color: #709870;">(</span>gerade-zahlen '<span style="color: #907373;">()</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">(</span>42<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>gerade-zahlen '<span style="color: #907373;">(</span>0<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">(</span>30 100<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>gerade-zahlen '<span style="color: #907373;">(</span>-12 7 58<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
<li><p>
Eine Funktion, die sich wie b) verhält, aber das Produkt aller Zahlen
zurückgibt.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">produkt</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? lvz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span><span style="color: #006FE0;">reduce</span> * 1 <span style="color: #709870;">(</span>gerade-zahlen lvz<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-produkt</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 1 <span style="color: #709870;">(</span>produkt '<span style="color: #907373;">()</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 42 <span style="color: #709870;">(</span>produkt '<span style="color: #907373;">(</span>0<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 3000 <span style="color: #709870;">(</span>produkt '<span style="color: #907373;">(</span>-12 7 58<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
<li><p>
Eine Funktion, die aus einer Liste von Zahlen alle Zahlen streicht,
die nicht durch 4 oder 5 teilbar sind.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">streiche45</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? lvz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span><span style="color: #0000FF;">let</span> <span style="color: #709870;">[</span>durch4teilbar <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>a<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span>= 0 <span style="color: #858580;">(</span><span style="color: #006FE0;">mod</span> a 4<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                 durch5teilbar <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>a<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span>= 0 <span style="color: #858580;">(</span><span style="color: #006FE0;">mod</span> a 5<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
           <span style="color: #709870;">(</span><span style="color: #006FE0;">filter</span> <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span><span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span>durch4teilbar x<span style="color: #858580;">)</span> 
                              <span style="color: #858580;">(</span>durch5teilbar x<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> lvz<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-streiche45</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">()</span> <span style="color: #709870;">(</span>streiche45 '<span style="color: #907373;">()</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">(</span>16<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>streiche45 '<span style="color: #907373;">(</span>16<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">()</span> <span style="color: #709870;">(</span>streiche45 '<span style="color: #907373;">(</span>17<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">(</span>12<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>streiche45 '<span style="color: #907373;">(</span>12 7 58<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
<li><p>
Eine Funktion, die die Summe der Quadrate der natürlichen Zahlen in
einer Liste berechnet.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">summe-der-quadrate</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? lvz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">number?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span><span style="color: #006FE0;">reduce</span> + 0 <span style="color: #709870;">(</span><span style="color: #006FE0;">map</span> lvz <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span>* x x<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-summe-der-quadrate</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 0 <span style="color: #709870;">(</span>summe-der-quadrate '<span style="color: #907373;">()</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 4 <span style="color: #709870;">(</span>summe-der-quadrate '<span style="color: #907373;">(</span>2<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 78 <span style="color: #709870;">(</span>summe-der-quadrate '<span style="color: #907373;">(</span>-2 7 5<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
<li><p>
Eine Funktion <code>und</code>, die genau dann <code>true</code> zurück liefert, wenn alle
Elemente einer Liste von Booleans <code>true</code> sind.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">und</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lvb<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #858580;">[</span>b<span style="color: #858580;">]</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">true?</span> b<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">false?</span> b<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span> lvb<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #0000FF;">or</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">true?</span> <span style="color: #BA36A5;">%</span><span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">false?</span> <span style="color: #BA36A5;">%</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span><span style="color: #006FE0;">reduce</span> <span style="color: #709870;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #907373;">[</span>x y<span style="color: #907373;">]</span> <span style="color: #907373;">(</span><span style="color: #0000FF;">and</span> x y<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #D0372D;">true</span> lvb<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-und</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #D0372D;">true</span> <span style="color: #709870;">(</span>und '<span style="color: #907373;">()</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #D0372D;">true</span> <span style="color: #709870;">(</span>und '<span style="color: #907373;">(</span><span style="color: #D0372D;">true</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #D0372D;">false</span> <span style="color: #709870;">(</span>und '<span style="color: #907373;">(</span><span style="color: #D0372D;">false</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #D0372D;">true</span> <span style="color: #709870;">(</span>und '<span style="color: #907373;">(</span><span style="color: #D0372D;">true</span> <span style="color: #D0372D;">true</span> <span style="color: #D0372D;">true</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #D0372D;">false</span> <span style="color: #709870;">(</span>und '<span style="color: #907373;">(</span><span style="color: #D0372D;">true</span> <span style="color: #D0372D;">true</span> <span style="color: #D0372D;">false</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
<li><p>
Eine Funktion <code>partitioniere</code>, die ein Prädikat als Argument nimmt
und, angewandt auf eine Liste, zwei Listen zurückgibt, wobei erstere
alle Elemente enthält, die das Prädikat erfüllen, und die andere die
restlichen Elemente enthält.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">partitioniere</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>praed? lvz<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? lvz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">list?</span> <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span><span style="color: #006FE0;">list</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">filter</span> praed? lvz<span style="color: #709870;">)</span>
                 <span style="color: #709870;">(</span><span style="color: #006FE0;">filter</span> <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">not</span> <span style="color: #858580;">(</span>praed? x<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> lvz<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-partitioniere</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">(</span><span style="color: #907373;">()</span> <span style="color: #907373;">()</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>partitioniere even? '<span style="color: #907373;">()</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">(</span><span style="color: #907373;">(</span>2<span style="color: #907373;">)</span> <span style="color: #907373;">()</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>partitioniere even? '<span style="color: #907373;">(</span>2<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">(</span><span style="color: #907373;">()</span> <span style="color: #907373;">(</span>3<span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>partitioniere even? '<span style="color: #907373;">(</span>3<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= '<span style="color: #709870;">(</span><span style="color: #907373;">(</span>-2<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>7 5<span style="color: #907373;">)</span><span style="color: #709870;">)</span> 
                       <span style="color: #709870;">(</span>partitioniere even? '<span style="color: #907373;">(</span>-2 7 5<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
<li><p>
Eine Funktion <code>sort</code>, die, angewendet auf eine Liste von Zahlen,
diese Liste absteigend sortiert.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sort : (list-of number)  -&gt;  (list-of number)</span>
       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">sort</span> 
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lst<span style="color: #909183;">]</span>
           <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span> 
               <span style="color: #709870;">[</span><span style="color: #907373;">(</span>insert <span style="color: #6276BA;">[</span>an alon<span style="color: #6276BA;">]</span>
                  <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span>
                     <span style="color: #858580;">(</span><span style="color: #006FE0;">empty?</span> alon<span style="color: #858580;">)</span> <span style="color: #858580;">(</span><span style="color: #006FE0;">list</span> an<span style="color: #858580;">)</span>
                     <span style="color: #858580;">(</span>&gt; an <span style="color: #80A880;">(</span><span style="color: #006FE0;">first</span> alon<span style="color: #80A880;">)</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span><span style="color: #006FE0;">cons</span> an alon<span style="color: #858580;">)</span>
                     <span style="color: #D0372D;">:else</span> 
                      <span style="color: #858580;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">first</span> alon<span style="color: #80A880;">)</span> 
                            <span style="color: #80A880;">(</span>insert an <span style="color: #887070;">(</span><span style="color: #006FE0;">rest</span> alon<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
             <span style="color: #709870;">(</span><span style="color: #006FE0;">reduce</span> insert <span style="color: #907373;">()</span> lst<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
<li><p>
Modifizieren Sie die Funktion <code>sort</code> aus 8. so, dass durch einen
zusätzlichen Parameter die Sortierreihenfolge bestimmt werden kann.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sort2: (list-of number) (number number -&gt; boolean) </span>
                  -&gt;  <span style="color: #707183;">(</span>list-of number<span style="color: #707183;">)</span>
       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">sort2</span> 
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lst updown<span style="color: #909183;">]</span>
           <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span>
               <span style="color: #709870;">[</span><span style="color: #907373;">(</span>insert <span style="color: #6276BA;">[</span>an alon<span style="color: #6276BA;">]</span>
                  <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span>
                   <span style="color: #858580;">(</span><span style="color: #006FE0;">empty?</span> alon<span style="color: #858580;">)</span> <span style="color: #858580;">(</span><span style="color: #006FE0;">list</span> an<span style="color: #858580;">)</span>
                   <span style="color: #858580;">(</span>updown an <span style="color: #80A880;">(</span><span style="color: #006FE0;">first</span> alon<span style="color: #80A880;">)</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span><span style="color: #006FE0;">cons</span> an alon<span style="color: #858580;">)</span>
                   <span style="color: #D0372D;">:else</span> <span style="color: #858580;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">first</span> alon<span style="color: #80A880;">)</span> 
                               <span style="color: #80A880;">(</span>insert an <span style="color: #887070;">(</span><span style="color: #006FE0;">rest</span> alon<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
             <span style="color: #709870;">(</span><span style="color: #006FE0;">reduce</span> insert <span style="color: #907373;">()</span> lst<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-orgb5067e8" class="outline-3">
<h3 id="orgb5067e8"><span class="section-number-3">1.20</span> Aufgabe (Definition von Funktionen höherer Ordnung)</h3>
<div class="outline-text-3" id="text-1-20">
<p>
Definieren Sie die folgenden Funktionen höherer Ordnung rekursiv oder
durch Verwendung von anderen Funktionen höherer Ordnung:
</p>

<ol class="org-ol">
<li><p>
Eine Funktion
</p>

<div class="org-src-container">
<pre class="src src-clojure">         <span style="color: #707183;">(</span><span style="color: #6434A3;">Number</span> -&gt; <span style="color: #6434A3;">Number</span><span style="color: #707183;">)</span> <span style="color: #707183;">(</span>Number-&gt; <span style="color: #6434A3;">Number</span><span style="color: #707183;">)</span> list-of <span style="color: #6434A3;">Number</span> 
            -&gt; list-of <span style="color: #6434A3;">Number</span>,</pre>
</pre>
</div>

<p>
die zwei Funktionen und eine Liste von Zahlen als Argument erhält und
auf jede Zahl zuerst die erste und dann die zweite Funktion anwendet.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">hintereinander</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>f g lvz<span style="color: #909183;">]</span>
           <span style="color: #909183;">{</span><span style="color: #D0372D;">:pre</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? lvz<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #D0372D;">:post</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span><span style="color: #006FE0;">every?</span> number? <span style="color: #BA36A5;">%</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span><span style="color: #909183;">}</span>
           <span style="color: #909183;">(</span><span style="color: #006FE0;">map</span> lvz <span style="color: #709870;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #907373;">[</span>x<span style="color: #907373;">]</span> <span style="color: #907373;">(</span>g <span style="color: #6276BA;">(</span>f x<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-hintereinander</span>
                <span style="color: #7388D6;">(</span><span style="color: #0000FF;">let</span> <span style="color: #909183;">[</span>f <span style="color: #709870;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #907373;">[</span>x<span style="color: #907373;">]</span> <span style="color: #907373;">(</span>* x x<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
                      g <span style="color: #709870;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #907373;">[</span>x<span style="color: #907373;">]</span> <span style="color: #907373;">(</span>- x 2<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">]</span>
                <span style="color: #909183;">(</span><span style="color: #006FE0;">is</span> <span style="color: #709870;">(</span>= '<span style="color: #907373;">()</span> <span style="color: #907373;">(</span>hintereinander f g '<span style="color: #6276BA;">()</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                <span style="color: #909183;">(</span><span style="color: #006FE0;">is</span> <span style="color: #709870;">(</span>= '<span style="color: #907373;">(</span>7<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>hintereinander f g '<span style="color: #6276BA;">(</span>3<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                <span style="color: #909183;">(</span><span style="color: #006FE0;">is</span> <span style="color: #709870;">(</span>= '<span style="color: #907373;">(</span>14<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>hintereinander f g '<span style="color: #6276BA;">(</span>4<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                <span style="color: #909183;">(</span><span style="color: #006FE0;">is</span> <span style="color: #709870;">(</span>= '<span style="color: #907373;">(</span>2 47 23<span style="color: #907373;">)</span> <span style="color: #907373;">(</span>hintereinander f g 
                                        '<span style="color: #6276BA;">(</span>-2 7 5<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
<li><p>
Eine Funktion
</p>

<div class="org-src-container">
<pre class="src src-clojure">          <span style="color: #707183;">(</span><span style="color: #6434A3;">Number</span> -&gt; <span style="color: #6434A3;">Number</span><span style="color: #707183;">)</span> <span style="color: #707183;">(</span><span style="color: #6434A3;">Number</span> -&gt; <span style="color: #6434A3;">Number</span><span style="color: #707183;">)</span> -&gt; <span style="color: #6434A3;">Number</span>,</pre>
</pre>
</div>

<p>
die zwei Funktionen als Argument erhält und die kleinste natürliche
Zahl sucht, für die diese beiden Funktionen dasselbe Ergebnis
liefern. Begrenzen Sie die Suche auf Zahlen bis 1000 und geben Sie
<code>nil</code> zurück, wenn keine passende Zahl gefunden wurde.
</p>

<div class="org-src-container">
<pre class="src src-clojure">       <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">gleiches-ergebnis</span>
         <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>f g<span style="color: #909183;">]</span>
           <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span>ge2 <span style="color: #6276BA;">[</span>f g n<span style="color: #6276BA;">]</span>
                       <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span>
                         <span style="color: #858580;">(</span>= <span style="color: #80A880;">(</span>f n<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span>g n<span style="color: #80A880;">)</span><span style="color: #858580;">)</span> n
                         <span style="color: #858580;">(</span>= n 1000<span style="color: #858580;">)</span> <span style="color: #D0372D;">nil</span>
                         <span style="color: #D0372D;">:else</span> <span style="color: #858580;">(</span>ge2 f g <span style="color: #80A880;">(</span>+ n 1<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
             <span style="color: #709870;">(</span>ge2 f g 0<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

       <span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-gleiches-ergebnis</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #D0372D;">nil</span> <span style="color: #709870;">(</span>gleiches-ergebnis <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span>* x x<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                                              <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span>- x 2<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 0 <span style="color: #709870;">(</span>gleiches-ergebnis + *<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 1 <span style="color: #709870;">(</span>gleiches-ergebnis <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span>* x x<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> 
                                            <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span>- 2 x<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= 9 <span style="color: #709870;">(</span>gleiches-ergebnis <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span>- 20 x<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> 
                                            <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span> <span style="color: #6276BA;">(</span>+ 2 x<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org8e79eab" class="outline-3">
<h3 id="org8e79eab"><span class="section-number-3">1.21</span> Aufgabe (Anwendung von mapp und reduce)</h3>
<div class="outline-text-3" id="text-1-21">
<p>
Was liefern die folgenden Ausdrücke:
</p>

<ol class="org-ol">
<li><p>
<code>((mapp abs) '( 4 -7 3))</code>
</p>

<p>
<code>(4 7 3)</code>
</p></li>
<li><p>
<code>(def betraege (mapp abs))</code>
</p>

<p>
Eine Funktion, die auf die Elemente einer Liste die Funktion <code>abs</code>
anwendet.
</p></li>
<li><p>
<code>(betraege '(4 -7 -3))</code>
</p>

<p>
<code>(4 7 3)</code>
</p></li>
<li><p>
<code>(reduce * ((mapp abs) '( 4 -7 3)) 1)</code>
</p>

<p>
84
</p></li>
</ol>
</div>
</div>

<div id="outline-container-org0ddbefe" class="outline-3">
<h3 id="org0ddbefe"><span class="section-number-3">1.22</span> Aufgabe &#x2013; der Vertrag von <code>mapp</code></h3>
<div class="outline-text-3" id="text-1-22">
<p>
Wie lautet er?
</p>
<div class="org-src-container">
<pre class="src src-clojure">        mapp: <span style="color: #707183;">(</span><span style="color: #D0372D;">X</span> -&gt; <span style="color: #D0372D;">Y</span><span style="color: #707183;">)</span> -&gt; <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span>listof <span style="color: #D0372D;">X</span><span style="color: #7388D6;">)</span> -&gt; <span style="color: #7388D6;">(</span>listof <span style="color: #D0372D;">Y</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>

<p>
<b>zum Vergleich:</b>
</p>

<div class="org-src-container">
<pre class="src src-clojure">        map: <span style="color: #707183;">(</span>listof <span style="color: #D0372D;">X</span><span style="color: #707183;">)</span> <span style="color: #707183;">(</span><span style="color: #D0372D;">X</span> -&gt; <span style="color: #D0372D;">Y</span><span style="color: #707183;">)</span> -&gt; <span style="color: #707183;">(</span>listof <span style="color: #D0372D;">Y</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgca0a51b" class="outline-3">
<h3 id="orgca0a51b"><span class="section-number-3">1.23</span> Aufgabe (Hilfsfunktionen mit akkumulierenden Parametern)</h3>
<div class="outline-text-3" id="text-1-23">
<ol class="org-ol">
<li><p>
Schreiben Sie die Funktion <code>sum</code>, die die Summe der
Elemente einer Liste von Zahlen berechnet, unter Benutzung einer
Hilfsfunktion mit akkumulierendem Parameter.  Verwenden Sie die
Funktiosnschablone aus der Vorlesung.  Formulieren Sie die
Akkumulatorinvariante.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">berechnet die Summe einer Liste von Zahlen</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">sum: (list-of number) -&gt; number</span>
<span style="color: #707183;">(</span>check-expect <span style="color: #7388D6;">(</span>sum '<span style="color: #909183;">(</span>1 2 3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> 6<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">sum</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">[</span>alon<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letrec</span>
        <span style="color: #709870;">(</span><span style="color: #907373;">[</span><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Akkumulatorinvariante:</span>
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">accu enth&#228;lt die Summe der Elemente aus alon, die denen aus alon1</span>
          <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">vorangehen</span>
          sum-acc
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">(</span>alon1 accu<span style="color: #858580;">)</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">cond</span>
              <span style="color: #80A880;">[</span><span style="color: #887070;">(</span>empty? alon1<span style="color: #887070;">)</span> accu<span style="color: #80A880;">]</span>
              <span style="color: #80A880;">[</span>else 
               <span style="color: #887070;">(</span>sum-acc <span style="color: #707183;">(</span>rest alon1<span style="color: #707183;">)</span> <span style="color: #707183;">(</span>+ <span style="color: #7388D6;">(</span>first alon1<span style="color: #7388D6;">)</span> accu<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">]</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">]</span><span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>sum-acc alon 0<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> </pre>
</pre>
</div></li>

<li><p>
Gegeben ist ein Weg in einem ungerichteten Graphen, dessen 
Knoten Orte repräsentieren und dessen Kanten mit den Entfernungen 
zwischen den Orten attributiert sind, z. B. so:
</p>


<div class="figure">
<p><img src="./entfernungen.png" alt="entfernungen.png" />
</p>
</div>

<p>
Entwickeln Sie eine Funktion, die aus einer Liste mit relativen 
Entfernungen eine Liste mit den absoluten Entfernungen der Orte 
vom Ursprungsort berechnet. Für den obigen Graphen soll also aus 
der Liste (120 90 70 65) die Liste (120 210 280 345) werden.
</p>
<ol class="org-ol">
<li><p>
Entwickeln Sie zunächst eine Funktion (ggf. mit Hilfsfunktion)
nach den bekannten Entwurfsvorschriften (ohne akkumulierende
Parameter).
</p>
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">ns</span> <span style="color: #6434A3;">relativ-absolut.clj</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #006FE0;">use</span> '<span style="color: #6434A3;">clojure.test</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">addiere-auf-jede</span> 
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>zahl lvz<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #006FE0;">map</span> <span style="color: #709870;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #907373;">[</span>z<span style="color: #907373;">]</span> <span style="color: #907373;">(</span>+ z zahl<span style="color: #907373;">)</span><span style="color: #709870;">)</span> lvz<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">relativ-&gt;absolut</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> lvz<span style="color: #709870;">)</span> <span style="color: #709870;">()</span>
      <span style="color: #D0372D;">:else</span> 
      <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #907373;">(</span><span style="color: #006FE0;">first</span> lvz<span style="color: #907373;">)</span>
            <span style="color: #907373;">(</span>addiere-auf-jede 
             <span style="color: #6276BA;">(</span><span style="color: #006FE0;">first</span> lvz<span style="color: #6276BA;">)</span> 
             <span style="color: #6276BA;">(</span>relativ-&gt;absolut <span style="color: #858580;">(</span><span style="color: #006FE0;">rest</span> lvz<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-relativ-&gt;absolut</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>relativ-&gt;absolut '<span style="color: #907373;">(</span>50 40 70 30 30<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span><span style="color: #006FE0;">list</span> 50 90 160 190 220<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #006FE0;">run-tests</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>

<li><p>
Diskutieren Sie, warum eine Hilfsfunktion mit akkumulierendem
Parameter sinnvoll ist.
</p>
<p>
<b>Loesung:</b> Warum akkumulierender Parameter? Weil die Hilfsfunktion wie die Hauptfunktion
  die Liste rekursiv abarbeitet!
</p></li>
<li><p>
Entwickeln Sie eine solche.
</p>
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">ns</span> <span style="color: #6434A3;">relativ-absolut-akku.clj</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #006FE0;">use</span> '<span style="color: #6434A3;">clojure.test</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">relativ-&gt;absolut</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>lvz<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span>
        <span style="color: #709870;">[</span><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Akkumulatorinvariante: akku-distanz ist die akku-</span>
         <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">mulierte Distanz derjenigen Elemente von lvz, die</span>
         <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">denen aus lvz1 vorangehen.</span>
         <span style="color: #907373;">(</span>relabs <span style="color: #6276BA;">[</span>lvz1 akku-distanz<span style="color: #6276BA;">]</span>
           <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span>
             <span style="color: #858580;">(</span><span style="color: #006FE0;">empty?</span> lvz1<span style="color: #858580;">)</span> <span style="color: #858580;">()</span>
             <span style="color: #D0372D;">:else</span> 
             <span style="color: #858580;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #80A880;">(</span>+ akku-distanz <span style="color: #887070;">(</span><span style="color: #006FE0;">first</span> lvz1<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                   <span style="color: #80A880;">(</span>relabs <span style="color: #887070;">(</span><span style="color: #006FE0;">rest</span> lvz1<span style="color: #887070;">)</span> 
                           <span style="color: #887070;">(</span>+ akku-distanz <span style="color: #707183;">(</span><span style="color: #006FE0;">first</span> lvz1<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>relabs lvz 0<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-relativ-&gt;absolut</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>relativ-&gt;absolut '<span style="color: #907373;">(</span>50 40 70 30 30<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span><span style="color: #006FE0;">list</span> 50 90 160 190 220<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #006FE0;">run-tests</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
</ol></li>
<li><p>
Definieren Sie eine Funktion <code>(singletons x)</code>, die als Argument
eine Liste von den Atomen <code>x</code> hat und als Ergebnis eine Liste von
den Atomen liefern soll, die in <code>x</code> genau einmal auftreten.
</p>
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">ns</span> <span style="color: #6434A3;">singletons.clj</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #006FE0;">use</span> '<span style="color: #6434A3;">clojure.test</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Loesung ohne Verwendung akkumulierender Parameter</span>

<span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">Test-Hilfsprozedur</span>
<span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">erzeugt Liste mit anzahl-maligem Auftreten von x</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">vervielfache</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>x anzahl<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #709870;">(</span>&lt;= anzahl 0<span style="color: #709870;">)</span> <span style="color: #709870;">()</span>
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> x <span style="color: #907373;">(</span>vervielfache x <span style="color: #6276BA;">(</span>- anzahl 1<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>


<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">entfernt jedes Duplikat aus list</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">singletons: (list-of atom) -&gt; (list-of atom)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">singletons</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>list<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
      <span style="color: #709870;">(</span><span style="color: #006FE0;">empty?</span> list<span style="color: #709870;">)</span> <span style="color: #709870;">()</span>
      <span style="color: #D0372D;">:else</span> 
      <span style="color: #709870;">(</span><span style="color: #0000FF;">let</span> <span style="color: #907373;">[</span>singlerest <span style="color: #6276BA;">(</span>singletons <span style="color: #858580;">(</span><span style="color: #006FE0;">rest</span> list<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">]</span>
        <span style="color: #907373;">(</span><span style="color: #0000FF;">cond</span>
          <span style="color: #6276BA;">(</span><span style="color: #006FE0;">some</span> #<span style="color: #858580;">(</span>= <span style="color: #BA36A5;">%</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">first</span> list<span style="color: #80A880;">)</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span><span style="color: #006FE0;">rest</span> list<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span><span style="color: #006FE0;">remove</span> #<span style="color: #858580;">(</span>= <span style="color: #BA36A5;">%</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">first</span> list<span style="color: #80A880;">)</span><span style="color: #858580;">)</span> singlerest<span style="color: #6276BA;">)</span>
          <span style="color: #D0372D;">:else</span> <span style="color: #6276BA;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #858580;">(</span><span style="color: #006FE0;">first</span> list<span style="color: #858580;">)</span> singlerest<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-singletons</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>singletons <span style="color: #907373;">()</span><span style="color: #709870;">)</span> <span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>singletons '<span style="color: #907373;">(</span>1 2 3 3 2 1 4 5 4<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span>5<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>singletons '<span style="color: #907373;">(</span>1 1 5 2 3 3 2 1 4 5 4<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>singletons <span style="color: #907373;">(</span>vervielfache 'a 100<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">run-tests</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>

<li value="4"><p>
Modifizieren die Funktion <code>(singletons x)</code> so, dass zwei
akkumulierende Parameter verwendet werden.  Der eine soll zum
Akkumulieren der Atome, die genau einmal in <code>x</code> auftreten, dienen,
der andere zum Akkumulieren der Atome, die mehrmals in <code>x</code>
auftreten.
</p>
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">ns</span> <span style="color: #6434A3;">singletons-akku.clj</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #006FE0;">use</span> '<span style="color: #6434A3;">clojure.test</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Loesung mit akkumulierenden Parametern</span>

<span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">Test-Hilfsprozedur</span>
<span style="color: #8D8D84;">;;</span><span style="color: #8D8D84; font-style: italic;">erzeugt Liste mit anzahl-maligem Auftreten von x</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">vervielfache</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>x anzahl<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #709870;">(</span>&lt;= anzahl 0<span style="color: #709870;">)</span> <span style="color: #709870;">()</span>
          <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> x <span style="color: #907373;">(</span>vervielfache x <span style="color: #6276BA;">(</span>- anzahl 1<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>


<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">entfernt jedes Duplikat aus list</span>
<span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">singletons: (list-of atom) -&gt; (list-of atom)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">singletons</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>list<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span>
        <span style="color: #709870;">[</span><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Fuer den Listenkopf ueberpruefe zuerst, ob er schon in</span>
         <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">multis vorhanden ist. </span>
         <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Wenn ja, braucht er nicht weiter verarbeitet zu werden. </span>
         <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Wenn nein, muss er zu multis hinzugefuegt werden, </span>
         <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">wenn er im Listenrumpf noch einmal auftritt, sonst zu</span>
         <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">singles.</span>
         <span style="color: #907373;">(</span><span style="color: #808080;">singletonsAccu</span>
           <span style="color: #6276BA;">[</span>list0 singles multis<span style="color: #6276BA;">]</span>
           <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span> 
             <span style="color: #858580;">(</span><span style="color: #006FE0;">empty?</span> list0<span style="color: #858580;">)</span> singles

             <span style="color: #858580;">(</span><span style="color: #006FE0;">some</span> #<span style="color: #80A880;">(</span>= <span style="color: #BA36A5;">%</span> <span style="color: #887070;">(</span><span style="color: #006FE0;">first</span> list0<span style="color: #887070;">)</span><span style="color: #80A880;">)</span> multis<span style="color: #858580;">)</span>
             <span style="color: #858580;">(</span><span style="color: #808080;">singletonsAccu</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">rest</span> list0<span style="color: #80A880;">)</span> singles multis<span style="color: #858580;">)</span>

             <span style="color: #858580;">(</span><span style="color: #006FE0;">some</span> #<span style="color: #80A880;">(</span>= <span style="color: #BA36A5;">%</span> <span style="color: #887070;">(</span><span style="color: #006FE0;">first</span> list0<span style="color: #887070;">)</span><span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">rest</span> list0<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
             <span style="color: #858580;">(</span><span style="color: #808080;">singletonsAccu</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">rest</span> list0<span style="color: #80A880;">)</span> 
                             singles 
                             <span style="color: #80A880;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #887070;">(</span><span style="color: #006FE0;">first</span> list0<span style="color: #887070;">)</span> multis<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
             <span style="color: #D0372D;">:else</span>
             <span style="color: #858580;">(</span><span style="color: #808080;">singletonsAccu</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">rest</span> list0<span style="color: #80A880;">)</span> 
                             <span style="color: #80A880;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #887070;">(</span><span style="color: #006FE0;">first</span> list0<span style="color: #887070;">)</span> singles<span style="color: #80A880;">)</span> 
                             multis<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span><span style="color: #808080;">singletonsAccu</span> list <span style="color: #907373;">()</span> <span style="color: #907373;">()</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">deftest</span> <span style="color: #006699;">test-singletons</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>singletons <span style="color: #907373;">()</span><span style="color: #709870;">)</span> <span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>singletons '<span style="color: #907373;">(</span>1 2 3 3 2 1 4 5 4<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">(</span>5<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>singletons '<span style="color: #907373;">(</span>1 1 5 2 3 3 2 1 4 5 4<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #006FE0;">is</span> <span style="color: #909183;">(</span>= <span style="color: #709870;">(</span>singletons <span style="color: #907373;">(</span>vervielfache 'a 100<span style="color: #907373;">)</span><span style="color: #709870;">)</span> '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #006FE0;">run-tests</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org63bbc9c" class="outline-2">
<h2 id="org63bbc9c"><span class="section-number-2">2</span> Teil 2 (6. Semester)</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-orge2d1b83" class="outline-3">
<h3 id="orge2d1b83"><span class="section-number-3">2.1</span> Aufgabe (alternative Listenimplementierung)</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Gegeben sind folgende Definitionen für <code>cons</code> und <code>first</code>:
</p>
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">ns</span> <span style="color: #6434A3;">dataasproc</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #006FE0;">use</span> '<span style="color: #6434A3;">clojure.test</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">cons</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>x y<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #709870;">[</span>m<span style="color: #709870;">]</span> <span style="color: #709870;">(</span>m x y<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">first</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>z<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>z <span style="color: #709870;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #907373;">[</span>p q<span style="color: #907373;">]</span> p<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
<ol class="org-ol">
<li><p>
Verifizieren Sie, dass der Ausdruck <code>(first (cons x y))</code> als
Resultat <code>x</code> liefert.
</p>
<p>
Der Ausdruck <code>(cons 3 4)</code> liefert eine Funktion, die ausgeschrieben
so aussieht:
</p>
<pre class="example">
(fn [m] (m 3 4)) 

</pre>
<p>
Demnach ist der Ausdruck <code>(first (cons 3 4))</code> gleich
</p>
<pre class="example">
(first (fn [m] (m 3 4))).

</pre>
<p>
Wertet man diesen Ausdruck gemäß Ersetzungsmodell aus ergeben sich
folgende äquivalente Ausdrücke:
</p>
<pre class="example">
((fn [z] (z (fn [p q] p))) (fn [m] (m 3 4)) )
((fn [m] (m 3 4)) (fn [p q] p))
((fn [p q] p) 3 4)
3

</pre></li>
<li><p>
Fügen Sie die passende Definition von <code>rest</code> hinzu.
</p>
<div class="org-src-container">
<pre class="src src-clojure">   <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">rest</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>z<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>z <span style="color: #709870;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #907373;">[</span>p q<span style="color: #907373;">]</span> q<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-orgb02b9b6" class="outline-3">
<h3 id="orgb02b9b6"><span class="section-number-3">2.2</span> Aufgabe (verzögerte Auswertung - Streams)</h3>
<div class="outline-text-3" id="text-2-2">
</div><div id="outline-container-orgb485931" class="outline-4">
<h4 id="orgb485931">Streams</h4>
<div class="outline-text-4" id="text-orgb485931">
<p>
Ein Stream ist eine unendliche Folge von Werten. Selbstverständlich
kann ein solche Folge nicht tatsächlich erzeugt werden - dies
beanspruchte unendlich viel Zeit. Es ist aber möglich, Code zu
erzeugen, der weiß, wie die Folge zu erzeugen ist und anderen Code,
der weiß, wieviel Elemente benötigt werden.
</p>

<p>
Die UNIX pipe <code>(cmd1 | cmd2)</code> ist ein Stream; sie sorgt dafür, dass <code>cmd1</code>
genau so viel Output erzeugt wie <code>cmd2</code> an Input verlangt.
Web-Programme, die auf Klicks von Benutzern auf Web-Seiten reagieren,
können die Benutzeraktivitäten als Stream betrachten &#x2013; ohne zu wissen,
wann die nächste Aktivität kommt und wie viele es sein werden &#x2013; und
entsprechend antworten.
</p>

<p>
Allgemeiner gesprochen: Streams stellen eine Art Arbeitsteilung dar:
Ein Teil der Software weiß, wie aufeinanderfolgende Werte der unendlichen
Folge zu erzeugen sind, weiß aber nicht, wie viele benötigt werden und
was mit ihnen passieren soll. Ein anderer Teil kann ermitteln, wie viele
Werte benötigt werden und was mit ihnen geschehen soll, weiß aber nicht,
wie sie zu erzeugen sind.
</p>

<p>
Es gibt viele Möglichkeiten, Streams zu implementieren. Hier werden wir
eine einfache Variante realisieren, die einen Stream als <i>thunk</i> repräsentiert,
der, wenn er aufgerufen wird, einen zweielementigen Vektor erzeugt, dessen
erstes Element den ersten Wert der unendlichen Folge enthält. Im zweiten
Element wird ein thunk abgelegt, der den Stream für das zweite und die
übrigen Elemente der unendlichen Folge repräsentiert.
</p>

<p>
Aus „nostalgischen” Gründen werden hier zunächst zwei Funktionen für den
Zugriff auf das erste (<code>car</code>) und das zweite (<code>cdr</code>) Element eines Vektors
definiert:
</p>
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">car</span> <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>v<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>v 0<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(v 0) ist das Gleiche wie (get v 0), wenn v ein Vektor</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">cdr</span> <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>v<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>v 1<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>

<p>
Die Definition von thunks für die Repäsentation unendlicher Folgen erfolgt
üblicherweise rekursiv.
</p>

<dl class="org-dl">
<dt>1. Beispiel:</dt><dd><p>
eine unendliche Folge von Einsen
</p>
<div class="org-src-container">
<pre class="src src-clojure">  <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">ones</span> <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[]</span> <span style="color: #909183;">[</span>1 ones<span style="color: #909183;">]</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
<p>
Machen Sie sich die Wirkung der folgenden Ausdrücke klar. Beachten
Sie die Klammern!
</p>
<div class="org-src-container">
<pre class="src src-clojure">  <span style="color: #707183;">(</span>ones<span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">;=&gt; [1 #function[user/ones]]</span>
  <span style="color: #707183;">(</span>car <span style="color: #7388D6;">(</span>ones<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">;=&gt; 1</span>
  <span style="color: #707183;">(</span>car <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>cdr <span style="color: #709870;">(</span>ones<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">;=&gt; 1</span></pre>
</pre>
</div></dd>

<dt>2. Beispiel:</dt><dd><p>
die natürlichen Zahlen
</p>
<div class="org-src-container">
<pre class="src src-clojure">  <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">nats</span>
    <span style="color: #7388D6;">(</span><span style="color: #0000FF;">letfn</span> <span style="color: #909183;">[</span><span style="color: #709870;">(</span>f <span style="color: #907373;">[</span>x<span style="color: #907373;">]</span> <span style="color: #907373;">[</span>x <span style="color: #6276BA;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #858580;">[]</span> <span style="color: #858580;">(</span>f <span style="color: #80A880;">(</span>+ x 1<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">]</span><span style="color: #709870;">)</span><span style="color: #909183;">]</span>
      <span style="color: #909183;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #709870;">[]</span> <span style="color: #709870;">(</span>f 1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
<p>
Machen Sie sich die Wirkung der folgenden Ausdrücke klar. Beachten Sie die
Klammern!
</p>
<div class="org-src-container">
<pre class="src src-clojure">  <span style="color: #707183;">(</span>car <span style="color: #7388D6;">(</span>nats<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">;=&gt; 1</span>
  <span style="color: #707183;">(</span>car <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>cdr <span style="color: #709870;">(</span>nats<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">;=&gt; 2</span>
  <span style="color: #707183;">(</span>car <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>cdr <span style="color: #709870;">(</span><span style="color: #907373;">(</span>cdr <span style="color: #6276BA;">(</span>nats<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>  <span style="color: #8D8D84; font-style: italic;">;=&gt; 3</span></pre>
</pre>
</div></dd>

<dt>3. Beispiel:</dt><dd><p>
die Zweierpotenzen
</p>
<div class="org-src-container">
<pre class="src src-clojure">  <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">powers-of-two</span>
    <span style="color: #7388D6;">(</span><span style="color: #0000FF;">letfn</span> <span style="color: #909183;">[</span><span style="color: #709870;">(</span>f <span style="color: #907373;">[</span>x<span style="color: #907373;">]</span> <span style="color: #907373;">[</span>x <span style="color: #6276BA;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #858580;">[]</span> <span style="color: #858580;">(</span>f <span style="color: #80A880;">(</span>* x 2<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">]</span><span style="color: #709870;">)</span><span style="color: #909183;">]</span>
      <span style="color: #909183;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #709870;">[]</span> <span style="color: #709870;">(</span>f 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
<p>
Machen Sie sich die Wirkung der folgenden Ausdrücke klar. Beachten Sie die
Klammern!
</p>
<div class="org-src-container">
<pre class="src src-clojure">  <span style="color: #707183;">(</span>car <span style="color: #7388D6;">(</span>powers-of-two<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">;=&gt; 2</span>
  <span style="color: #707183;">(</span>car <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>cdr <span style="color: #709870;">(</span>powers-of-two<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">;=&gt; 4</span>
  <span style="color: #707183;">(</span>car <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>cdr <span style="color: #709870;">(</span><span style="color: #907373;">(</span>cdr <span style="color: #6276BA;">(</span>powers-of-two<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">;=&gt; 8</span></pre>
</pre>
</div></dd>
</dl>

<p>
Man könnte eine Funktion höherer Ordnung schreiben, die einen Stream und
ein Prädikat als Argumente akzeptiert und eine Zahl zurückgibt, die sagt,
wieviele Elemente des Streams erzeugt werden müssen, bevor das Prädikat
<code>true</code> liefert:
</p>
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">number-until</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>stream tester<span style="color: #909183;">]</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span>f <span style="color: #6276BA;">[</span>stream answer<span style="color: #6276BA;">]</span>
              <span style="color: #6276BA;">(</span><span style="color: #0000FF;">let</span> <span style="color: #858580;">[</span>pr <span style="color: #80A880;">(</span>stream<span style="color: #80A880;">)</span><span style="color: #858580;">]</span>
                <span style="color: #858580;">(</span><span style="color: #0000FF;">if</span> <span style="color: #80A880;">(</span>tester <span style="color: #887070;">(</span>car pr<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                  answer
                  <span style="color: #80A880;">(</span>f <span style="color: #887070;">(</span>cdr pr<span style="color: #887070;">)</span> <span style="color: #887070;">(</span>+ answer 1<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
      <span style="color: #709870;">(</span>f stream 1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
<p>
Beispielanwendung:
</p>
<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #707183;">(</span>number-until powers-of-two <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>x<span style="color: #909183;">]</span> <span style="color: #909183;">(</span>&gt; x 16<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">;=&gt; 5</span></pre>
</pre>
</div>
</div>
</div>

<div id="outline-container-org57e2849" class="outline-4">
<h4 id="org57e2849">Aufgaben</h4>
<div class="outline-text-4" id="text-org57e2849">
<ol class="org-ol">
<li><p>
Schreiben Sie eine Funktion <code>stream-for-n-steps</code>, die einen Stream
<code>s</code> und eine Zahl <code>n</code> nimmt. Sie gibt eine Liste mit den ersten <code>n</code>
Elementen von <code>s</code> zurück. (Lösung erfordert ca. 4 Zeilen.)
</p>
<div class="org-src-container">
<pre class="src src-clojure">   <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">stream-for-n-steps</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>s n<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">cond</span>
         <span style="color: #709870;">(</span>= n 0<span style="color: #709870;">)</span> <span style="color: #709870;">()</span>
         <span style="color: #D0372D;">:else</span> <span style="color: #709870;">(</span><span style="color: #006FE0;">cons</span> <span style="color: #907373;">(</span>car <span style="color: #6276BA;">(</span>s<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span> <span style="color: #907373;">(</span>stream-for-n-steps <span style="color: #6276BA;">(</span>cdr <span style="color: #858580;">(</span>s<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>- n 1<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
<p>
Beispielanwendung:
</p>
<div class="org-src-container">
<pre class="src src-clojure">   <span style="color: #707183;">(</span>stream-for-n-steps powers-of-two 5<span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">;=&gt; (2 4 8 16 32)</span></pre>
</pre>
</div></li>

<li><p>
Schreiben Sie einen Stream <code>funny-number-stream</code>, der dem für
natürliche Zahlen ähnelt, nur sollen alle durch 5 teilbaren Zahlen
negiert werden, z. B. \(1, 2, 3, 4, -5, 6, 7, 8, 9, -10, 11, \ldots\). 
</p>

<p>
Testen Sie die Funktion mithilfe von <code>stream-for-n-steps</code>.
</p>
<div class="org-src-container">
<pre class="src src-clojure">   <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">funny-number-stream</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">letfn</span> <span style="color: #909183;">[</span><span style="color: #709870;">(</span>f <span style="color: #907373;">[</span>x<span style="color: #907373;">]</span> <span style="color: #907373;">[</span><span style="color: #6276BA;">(</span><span style="color: #0000FF;">if</span> <span style="color: #858580;">(</span>= <span style="color: #80A880;">(</span><span style="color: #006FE0;">mod</span> x 5<span style="color: #80A880;">)</span> 0<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>- x<span style="color: #858580;">)</span> x<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #858580;">[]</span> <span style="color: #858580;">(</span>f <span style="color: #80A880;">(</span>+ x 1<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">]</span><span style="color: #709870;">)</span><span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #709870;">[]</span> <span style="color: #709870;">(</span>f 1<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

   <span style="color: #707183;">(</span>stream-for-n-steps funny-number-stream 12<span style="color: #707183;">)</span>
                                           <span style="color: #8D8D84; font-style: italic;">;=&gt; (1 2 3 4 -5 6 7 8 9 -10 11 12)</span></pre>
</pre>
</div></li>
<li><p>
Zusatzaufgabe (optional)
Die Streams <code>ones</code>, <code>nats</code> und <code>powers-of-two</code> haben gemeinsam, dass für die
Berechnung des nächsten Elements maximal das vorherige bekannt sein
muss. Daher ist es nahe liegend, eine Funktion höherer Ordnung
<code>stream-maker</code> zu schreiben, die aus dem ersten Element und einer
Funktion zur Berechnung des nächsten einen Stream baut. 
</p>
<div class="org-src-container">
<pre class="src src-clojure">   <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">stream-maker</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>fkt arg<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span> <span style="color: #709870;">[</span><span style="color: #907373;">(</span>f <span style="color: #6276BA;">[</span>x<span style="color: #6276BA;">]</span>
                 <span style="color: #6276BA;">[</span>x <span style="color: #858580;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #80A880;">[]</span> <span style="color: #80A880;">(</span>f <span style="color: #887070;">(</span>fkt x arg<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">]</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #709870;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #907373;">[]</span> <span style="color: #907373;">(</span>f arg<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org5cd3568" class="outline-3">
<h3 id="org5cd3568"><span class="section-number-3">2.3</span> Aufgabe (Umgebungsdiagramme)</h3>
<div class="outline-text-3" id="text-2-3">
<ol class="org-ol">
<li><p>
Grundlage:
</p>
<div class="org-src-container">
<pre class="src src-clojure">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nimmt einen Betrag als Startkapital eines Kontos</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">und erzeugt eine "belaste-Funktion"</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">erzeuge-konto: (number -&gt; (number -&gt; (mixed number symbol)))</span>
   <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">erzeuge-konto</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>startwert<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">let</span> <span style="color: #709870;">[</span>konto <span style="color: #907373;">(</span><span style="color: #006FE0;">atom</span> startwert<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #709870;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #907373;">[</span>betrag<span style="color: #907373;">]</span>
           <span style="color: #907373;">(</span><span style="color: #0000FF;">cond</span>
             <span style="color: #6276BA;">(</span>&gt;= @konto betrag<span style="color: #6276BA;">)</span>
             <span style="color: #6276BA;">(</span><span style="color: #0000FF;">do</span>
               <span style="color: #858580;">(</span><span style="color: #006FE0;">swap!</span> konto - betrag<span style="color: #858580;">)</span>
               @konto<span style="color: #6276BA;">)</span>

             <span style="color: #D0372D;">:else</span> 'konto-ueberzogen<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>

<ol class="org-ol">
<li><p>
Wie sieht das Umgebungsdiagramm aus, wenn zwei Konten angelegt
werden?
</p>

<p>
<code>(def konto1 (erzeuge-konto 100))</code><br />
<code>(def konto2 (erzeuge-konto 200))</code>
</p>

<div class="figure">
<p><img src="./erzeuge2konten.png" alt="erzeuge2konten.png" width="600px" />
</p>
</div></li>

<li><p>
Stellen Sie die Auswertung von <code>(konto2 120)</code> dar!
</p>
<p width="600px">
<img src="./konto2-120.png" alt="konto2-120.png" width="600px" />
Nach der Auswertung des Ausdrucks verschwindet die Umgebung E3 wieder.
</p></li>

<li><p>
Wie sieht das Umgebungsdiagramm aus für?
</p>

<p>
<code>(def konto1 (erzeuge-konto 100))</code><br />
<code>(def konto2 konto1)</code>
</p>

<div class="figure">
<p><img src="./definekonto2konto1.png" alt="definekonto2konto1.png" width="600px" />
</p>
</div></li>
</ol></li>

<li><p>
Betrachten Sie die folgende Variante der Prozedur <code>erzeuge-konto</code>.
Machen Sie sich ihre Wirkungsweise klar.
</p>

<div class="org-src-container">
<pre class="src src-clojure">   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">erzeuge-konto (number -&gt; (symbol -&gt; (number -&gt; (mixed number symbol))))</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">nimmt einen Betrag als Startkapital und erzeugt ein "Konto-Object"</span>
   <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">erzeuge-konto</span>
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>startkapital<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">let</span>
           <span style="color: #709870;">[</span><span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Exemplarvariable</span>
            konto <span style="color: #907373;">(</span><span style="color: #006FE0;">atom</span> startkapital<span style="color: #907373;">)</span>

            <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Exemplarmethoden:</span>
            <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">belaste: (number -&gt; (mixed number symbol))</span>
            <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Effekt: bucht vom konto betrag ab, liefert neuen </span>
            <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Kontostand als Resultat, falls Konto nicht ueberzogen</span>
            belaste
            <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>betrag<span style="color: #6276BA;">]</span>
              <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span>
                <span style="color: #858580;">(</span>&gt;= @konto betrag<span style="color: #858580;">)</span>
                <span style="color: #858580;">(</span><span style="color: #0000FF;">do</span>
                  <span style="color: #80A880;">(</span><span style="color: #006FE0;">swap!</span> konto - betrag<span style="color: #80A880;">)</span>
                  @konto<span style="color: #858580;">)</span>
                <span style="color: #D0372D;">:else</span> 'konto-ueberzogen<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
            <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">schreibegut: (number -&gt; number)</span>
            <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">Effekt: schreibt konto betrag gut</span>
            <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">liefert neuen Kontostand als Resultat</span>
            schreibegut
            <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>betrag<span style="color: #6276BA;">]</span>
              <span style="color: #6276BA;">(</span><span style="color: #0000FF;">do</span>
                <span style="color: #858580;">(</span><span style="color: #006FE0;">swap!</span> konto + betrag<span style="color: #858580;">)</span>
                @konto<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>

            <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">method dispatcher</span>
            <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">verteile: (number -&gt; (mixed number symbol))</span>
            <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">verwaltet die von Konten verstandenen Nachrichten</span>
            verteile
            <span style="color: #907373;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #6276BA;">[</span>nachricht<span style="color: #6276BA;">]</span>
              <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span>
                <span style="color: #858580;">(</span>= nachricht 'belaste<span style="color: #858580;">)</span> belaste
                <span style="color: #858580;">(</span>= nachricht 'schreibegut<span style="color: #858580;">)</span> schreibegut
                <span style="color: #D0372D;">:else</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">throw</span> <span style="color: #80A880;">(</span><span style="color: #6434A3;">Exception.</span> <span style="color: #008000;">"unbekannte Nachricht"</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         verteile<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div>
<p>
Wie sieht das Umgebungsdiagramm für die folgende Ausdruckssequenz
aus:
</p>

<p>
<code>(def konto (erzeuge-konto 200))</code>
</p>

<div class="figure">
<p><img src="./defkontoerzeugekonto200.png" alt="defkontoerzeugekonto200.png" width="600px" />
</p>
</div>

<p>
<code>((konto 'schreibegut) 60)</code><br />
</p>

<div class="figure">
<p><img src="./schreibegut60.png" alt="schreibegut60.png" width="600px" />
</p>
</div>
<p>
Nach der Auswertung des Ausdrucks verschwinden die Umgebungen E2 und E3
wieder.
</p>

<p>
<code>((konto 'belaste) 120)</code>
</p></li>
</ol>
</div>
</div>

<div id="outline-container-org707b05b" class="outline-3">
<h3 id="org707b05b"><span class="section-number-3">2.4</span> Aufgabe (Constraint Propagation)</h3>
<div class="outline-text-3" id="text-2-4">
<ol class="org-ol">
<li>Unter Verwendung der aus der Vorlesung bekannten <i>primitive constraints</i>
<code>multiplier</code>, <code>adder</code> und <code>constant</code> schreiben Sie eine Prozedur
<code>averager</code>, die drei Konnektoren <code>a</code>, <code>b</code> und <code>c</code> als Eingänge
benutzt und ein Constraint so implementiert, dass der Wert von <code>c</code>
der Mittelwert der Werte an <code>a</code> und <code>b</code> ist.</li>

<li><p>
Schreiben Sie für die Zinseszins-Formel:
</p>

<p>
\[\frac{K_{n}}{K_{0}}=(1+\frac{p}{100})^{n}\]
</p>

<p>
eine Constraint-Programming-Spezifikation. Orientieren Sie sich dabei 
an dem Celsius-Fahrenheit-Konverter aus der Vorlesung. Die
Clojure-Implementierung finden Sie in moodle im TB <i>Beispiele</i> unter<br />
<code>celsius-fahrenheit.clj</code>.<br />
Am gleichen Ort unter<br />
<code>sicp-cps.zip</code> <br />
finden Sie ein Leiningen-Projekt mit der Implementierung des für den 
Celsius-Fahrenheit-Konverter benutzten Constraint-Propagation-Systems
aus der Vorlesung.
</p>

<p>
Gehen Sie wie folgt vor:
</p>
<ol class="org-ol">
<li><p>
Erweitern Sie das Constraint-Programming-System um einen
<code>exponentiator</code> (in Anlehnung an <code>adder</code> bzw. <code>multiplier</code>, der die
Gleichung \(z = x^y\) löst!
</p>
<div class="org-src-container">
<pre class="src src-clojure">      <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">potentiator</span>
        <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>x y z<span style="color: #909183;">]</span>
          <span style="color: #909183;">(</span><span style="color: #0000FF;">letfn</span>
              <span style="color: #709870;">[</span><span style="color: #907373;">(</span>process-new-value <span style="color: #6276BA;">[]</span>
                 <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">and</span> <span style="color: #80A880;">(</span>has-value? x<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span>has-value? y<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                       <span style="color: #858580;">(</span>set-value! z
                                   <span style="color: #80A880;">(</span><span style="color: #6434A3;">Math</span><span style="font-family: DejaVu Sans Mono,monospace,sans-serif; color: #000000; background-color: #FFFFFF;">/</span>pow <span style="color: #887070;">(</span>get-value x<span style="color: #887070;">)</span> <span style="color: #887070;">(</span>get-value y<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                                   me<span style="color: #858580;">)</span>
                       <span style="color: #858580;">(</span><span style="color: #0000FF;">and</span> <span style="color: #80A880;">(</span>has-value? x<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span>has-value? z<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                       <span style="color: #858580;">(</span>set-value! y
                                   <span style="color: #80A880;">(</span>/ <span style="color: #887070;">(</span><span style="color: #6434A3;">Math</span><span style="font-family: DejaVu Sans Mono,monospace,sans-serif; color: #000000; background-color: #FFFFFF;">/</span>log <span style="color: #707183;">(</span>get-value z<span style="color: #707183;">)</span><span style="color: #887070;">)</span> <span style="color: #887070;">(</span><span style="color: #6434A3;">Math</span><span style="font-family: DejaVu Sans Mono,monospace,sans-serif; color: #000000; background-color: #FFFFFF;">/</span>log <span style="color: #707183;">(</span>get-value x<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                                   me<span style="color: #858580;">)</span>
                       <span style="color: #858580;">(</span><span style="color: #0000FF;">and</span> <span style="color: #80A880;">(</span>has-value? y<span style="color: #80A880;">)</span> <span style="color: #80A880;">(</span>has-value? z<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                       <span style="color: #858580;">(</span>set-value! x
                                   <span style="color: #80A880;">(</span><span style="color: #6434A3;">Math</span><span style="font-family: DejaVu Sans Mono,monospace,sans-serif; color: #000000; background-color: #FFFFFF;">/</span>pow <span style="color: #887070;">(</span>get-value z<span style="color: #887070;">)</span> <span style="color: #887070;">(</span>/ 1 <span style="color: #707183;">(</span>get-value y<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                                   me<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
               <span style="color: #907373;">(</span>process-forget-value <span style="color: #6276BA;">[]</span>
                 <span style="color: #6276BA;">(</span>forget-value! z me<span style="color: #6276BA;">)</span>
                 <span style="color: #6276BA;">(</span>forget-value! x me<span style="color: #6276BA;">)</span>
                 <span style="color: #6276BA;">(</span>forget-value! y me<span style="color: #6276BA;">)</span>
                 <span style="color: #6276BA;">(</span>process-new-value<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
               <span style="color: #907373;">(</span>me <span style="color: #6276BA;">[</span>request<span style="color: #6276BA;">]</span>
                 <span style="color: #6276BA;">(</span><span style="color: #0000FF;">cond</span> <span style="color: #858580;">(</span>= request 'I-have-a-value<span style="color: #858580;">)</span>  <span style="color: #858580;">(</span>process-new-value<span style="color: #858580;">)</span>
                       <span style="color: #858580;">(</span>= request 'I-lost-my-value<span style="color: #858580;">)</span> <span style="color: #858580;">(</span>process-forget-value<span style="color: #858580;">)</span>
                       <span style="color: #D0372D;">:else</span>
                       <span style="color: #858580;">(</span><span style="color: #0000FF;">throw</span> <span style="color: #80A880;">(</span><span style="color: #6434A3;">Exception.</span> <span style="color: #008000;">"Unknown request -- potentiator"</span> request<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">]</span>
            <span style="color: #709870;">(</span>connect x me<span style="color: #709870;">)</span>
            <span style="color: #709870;">(</span>connect y me<span style="color: #709870;">)</span>
            <span style="color: #709870;">(</span>connect z me<span style="color: #709870;">)</span>
            me<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span></pre>
</pre>
</div></li>
<li>Zeichnen Sie ein \glqq Schaltbild\grqq{} für die 
Zinseszins-Formel!</li>
<li>Setzen Sie dann das Schaltbild in eine Clojure-Lösung nach dem
Vorbild des Celsius-Fahrenheit-Konverters um!</li>
<li>Testen Sie Ihre Lösung, indem Sie Werte für jeweils 3 von 4 Größen
der Formel vorgeben.</li>
</ol>
<div class="org-src-container">
<pre class="src src-clojure">   <span style="color: #707183;">(</span><span style="color: #0000FF;">ns</span> <span style="color: #6434A3;">sicp-cps.zinseszins</span>
     <span style="color: #7388D6;">(</span><span style="color: #D0372D;">:require</span> <span style="color: #909183;">[</span><span style="color: #6434A3;">sicp-cps.core</span> <span style="color: #D0372D;">:refer</span> <span style="color: #D0372D;">:all</span><span style="color: #909183;">]</span>
               <span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

   <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">zinseszins</span> 
     <span style="color: #7388D6;">(</span><span style="color: #0000FF;">fn</span> <span style="color: #909183;">[</span>kn k0 p n<span style="color: #909183;">]</span>
       <span style="color: #909183;">(</span><span style="color: #0000FF;">let</span> <span style="color: #709870;">[</span>a <span style="color: #907373;">(</span>make-connector<span style="color: #907373;">)</span>
             b <span style="color: #907373;">(</span>make-connector<span style="color: #907373;">)</span>
             c <span style="color: #907373;">(</span>make-connector<span style="color: #907373;">)</span>
             eins <span style="color: #907373;">(</span>make-connector<span style="color: #907373;">)</span>
             hundert <span style="color: #907373;">(</span>make-connector<span style="color: #907373;">)</span><span style="color: #709870;">]</span>
         <span style="color: #709870;">(</span>multiplier k0 a kn<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>adder eins b c<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>multiplier hundert b p<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>potentiator c n a<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>constant 1 eins<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>constant 100 hundert<span style="color: #709870;">)</span>
         'ok<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">KN</span> <span style="color: #7388D6;">(</span>make-connector<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">K0</span> <span style="color: #7388D6;">(</span>make-connector<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">P</span> <span style="color: #7388D6;">(</span>make-connector<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span><span style="color: #0000FF;">def</span> <span style="color: #BA36A5;">N</span> <span style="color: #7388D6;">(</span>make-connector<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span>zinseszins <span style="color: #D0372D;">KN</span> <span style="color: #6434A3;">K0</span> <span style="color: #D0372D;">P</span> <span style="color: #D0372D;">N</span><span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span>probe <span style="color: #008000;">"KN"</span> <span style="color: #D0372D;">KN</span><span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span>probe <span style="color: #008000;">"K0"</span> <span style="color: #6434A3;">K0</span><span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span>probe <span style="color: #008000;">"P"</span> <span style="color: #D0372D;">P</span><span style="color: #707183;">)</span>
    <span style="color: #707183;">(</span>probe <span style="color: #008000;">"N"</span> <span style="color: #D0372D;">N</span><span style="color: #707183;">)</span>

   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! N 50.93048347119194 'user)</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! P 5 'user)</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! K0 1000 'user)</span>

   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! N 50.93048347119194 'user)</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! P 5 'user)</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! KN 12000 'user) </span>

   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! N 50.93048347119194 'user)</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! KN 12000 'user)</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! K0 1000 'user)</span>

   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! KN 12000 'user)</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! P 5 'user)</span>
   <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">(set-value! K0 1000 'user)</span></pre>
</pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-orgf2eb2d7" class="outline-3">
<h3 id="orgf2eb2d7"><span class="section-number-3">2.5</span> Aufgabe (Prolog)</h3>
<div class="outline-text-3" id="text-2-5">
<ol class="org-ol">
<li><p>
Schreiben Sie ein Prolog-Programm, dass festhält:
</p>
<ul class="org-ul">
<li>ein Löwe, ein Tiger und eine Kuh sind Lebewesen;</li>
<li>Löwe und Tiger sind Fleichfresser.<br /></li>
</ul>
<p>
Anschließend testen Sie Ihr Programm durch Eingabe der folgenden
Zielausdrücke:
</p>
<ul class="org-ul">
<li>Es gibt ein Lebewesen Tiger in der Datenbank.</li>
<li>Eine Kuh und ein Tiger sind beide Lebewesen (Konjunktion zweier Ziele).</li>
<li>Ein Löwe ist ein Lebewesen und Fleichfresser.</li>
<li>Ein Kuh ist ein Lebewesen und Fleichfresser.</li>
</ul>
<div class="org-src-container">
<pre class="src src-prolog"><span style="color: #006699;">lebewesen</span>(loewe).
<span style="color: #006699;">lebewesen</span>(kuh).
<span style="color: #006699;">lebewesen</span>(tiger).
<span style="color: #006699;">fleischfresser</span>(loewe).
<span style="color: #006699;">fleischfresser</span>(tiger).

?- <span style="color: #8D8D84; font-style: italic;">% Es gibt ein Lebewesen Tiger in der Datenbank:</span>
<span style="color: #0000FF;">|</span>    lebewesen(<span style="color: #BA36A5;">X</span>).
<span style="color: #BA36A5;">X</span> = loewe 

?- <span style="color: #8D8D84; font-style: italic;">% Eine Kuh und ein Tiger sind beide Lebewesen:</span>
<span style="color: #0000FF;">|</span>    lebewesen(kuh), lebewesen(tiger).
true.

?- <span style="color: #8D8D84; font-style: italic;">%Ein L&#246;we ist ein Lebewesen und Fleichfresser:</span>
<span style="color: #0000FF;">|</span>    lebewesen(loewe), fleischfresser(loewe).
true.

 <span style="color: #8D8D84; font-style: italic;">% Ein Kuh ist ein Lebewesen und Fleichfresser:</span>
<span style="color: #0000FF;">|</span>    lebewesen(kuh), fleischfresser(kuh).
false.</pre>
</pre>
</div></li>
<li><p>
Gegeben seien die folgenden biblischen Verwandtschaftsverhältnisse:
</p>
<div class="org-src-container">
<pre class="src src-prolog">   father(abraham,isaac).
   father(haran,lot).
   father(haran,milcah).
   father(haran,yiscah).
   male(isaac).
   male(lot).
   female(milcah).
   female(yiscah).
   son(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>) :- father(<span style="color: #BA36A5;">Y</span>,<span style="color: #BA36A5;">X</span>), male(<span style="color: #BA36A5;">X</span>).
   daughter(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>) :- father(<span style="color: #BA36A5;">Y</span>,<span style="color: #BA36A5;">X</span>), female(<span style="color: #BA36A5;">X</span>).</pre>
</pre>
</div>
<p>
Fügen Sie die Prädikate <code>sister/2</code>, <code>brother/2</code> und <code>siblings/2</code>
hinzu.
</p>
<div class="org-src-container">
<pre class="src src-prolog"><span style="color: #006699;">sister</span>(<span style="color: #BA36A5;">X</span>, <span style="color: #BA36A5;">Y</span>) :- father(<span style="color: #BA36A5;">Z</span>, <span style="color: #BA36A5;">X</span>), father(<span style="color: #BA36A5;">Z</span>, <span style="color: #BA36A5;">Y</span>), female(<span style="color: #BA36A5;">X</span>), <span style="color: #BA36A5;">X</span> \= <span style="color: #BA36A5;">Y</span>.
<span style="color: #006699;">brother</span>(<span style="color: #BA36A5;">X</span>, <span style="color: #BA36A5;">Y</span>) :- father(<span style="color: #BA36A5;">Z</span>, <span style="color: #BA36A5;">X</span>), father(<span style="color: #BA36A5;">Z</span>, <span style="color: #BA36A5;">Y</span>), male(<span style="color: #BA36A5;">X</span>), <span style="color: #BA36A5;">X</span> \= <span style="color: #BA36A5;">Y</span>.
<span style="color: #006699;">siblings</span>(<span style="color: #BA36A5;">X</span>, <span style="color: #BA36A5;">Y</span>) :- father(<span style="color: #BA36A5;">Z</span>, <span style="color: #BA36A5;">X</span>), father(<span style="color: #BA36A5;">Z</span>, <span style="color: #BA36A5;">Y</span>), <span style="color: #BA36A5;">X</span> \= <span style="color: #BA36A5;">Y</span>.
</pre>
</pre>
</div></li>

<li><p>
Gegeben sei die folgende Faktenbasis über Reisemöglichkeiten:
</p>
<div class="org-src-container">
<pre class="src src-prolog">   byCar(auckland,hamilton).
   byCar(hamilton,raglan).
   byCar(valmont,saarbruecken).
   byCar(valmont,metz).

   byTrain(metz,frankfurt).
   byTrain(saarbruecken,frankfurt).
   byTrain(metz,paris).
   byTrain(saarbruecken,paris).

   byPlane(frankfurt,bangkok).
   byPlane(frankfurt,singapore).
   byPlane(paris,losAngeles).
   byPlane(bangkok,auckland).
   byPlane(losAngeles,auckland).</pre>
</pre>
</div>
<ol class="org-ol">
<li><p>
Schreiben Sie ein Prädikat <code>travel/2</code>, das ermittelt, ob es
möglich ist, von einem Ort zu einem anderen zu reisen, indem
der Reiseweg aus den in der Faktenbasis gegebenen Direktverbindungen verkettet
wird. Z. B. sollte die Frage
<code>travel(valmont,raglan).</code> als Resultat <code>true</code> liefern. 
</p>

<p>
<b>Hinweis</b>: Es könnte hilfreich sein, ein Prädikat <code>onestep/2</code> zu definieren,
das die Möglichkeiten zusammenfasst, welche Direktverbindungen
aufgrund der gegebenen Fakten existieren.
</p>

<div class="org-src-container">
<pre class="src src-prolog">      travel(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>) :- onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>).
      travel(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>) :- onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Z</span>),
                     travel(<span style="color: #BA36A5;">Z</span>,<span style="color: #BA36A5;">Y</span>).

      onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>) :- byCar(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>).
      onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>) :- byTrain(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>).
      onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>) :- byPlane(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>).</pre>
</pre>
</div></li>

<li><p>
Das Prädikat <code>travel/2</code> ermöglicht zu beweisen, dass es z. B. einen Reiseweg
von Valmont nach Raglan gibt. Für eine detaillierte Reiseplanung
wäre es aber wünschenswert, auch zu erfahren, über welche
Zwischenstationen die Reise führt. Schreiben Sie dafür ein
Prädikat <code>travel/3</code>, das dann z. B. auf die Frage<br />
<code>travel(valmont,paris, go(valmont,metz,go(metz,paris)))</code><br />
mit <code>true</code> und auf die Frage<br />
<code>travel(valmont,losAngeles,X).</code> <br />
mit<br />
<code>X = go(valmont,metz,go(metz,paris,go(paris,losAngeles)))</code> <br />
antwortet. Hier gibt es möglicherweise Alternativen.
</p>

<p>
<b>Hinweis</b>: Jeder Zwischenschritt auf der Reise muss registriert
werden. Betrachten Sie zuerst den Basisfall der Rekursion
<code>(travel(X,Y) :- onestep(X,Y).)</code> und erweitern ihn so, dass
<code>travel</code> in seinem dritten Argument speichert, dass ein Schritt
von <code>X</code> nach <code>Y</code> zurückgelegt wurde.
</p>

<p>
Betrachen Sie anschließend die rekursive Regel:
</p>
<pre class="example">
travel(X,Y) :- onestep(X,Z), travel(Z,Y).

</pre>
<p>
Diese Klausel sollte eine Struktur zurückgeben, die anzeigt, dass ein Schritt
von <code>X</code> nach <code>Z</code> zurücklegt und welcher Weg von <code>Z</code> nach <code>Y</code>
genommen werden muss.
</p>

<div class="org-src-container">
<pre class="src src-prolog">      travel(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>,go(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>)) :- onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>).
      travel(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>,go(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Z</span>,<span style="color: #BA36A5;">Path</span>)) :- onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Z</span>), 
                                  travel(<span style="color: #BA36A5;">Z</span>,<span style="color: #BA36A5;">Y</span>,<span style="color: #BA36A5;">Path</span>).</pre>
</pre>
</div></li>

<li><p>
Erweitern Sie das Prädikat <code>travel/3</code> so, dass auch angezeigt wird,
mit welchem Verkehrsmittel die jeweilige Teilstrecke
zurückgelegt wird.
</p>

<p>
<b>Hinweis</b>: Für jede Teilstrecke muss man sich merken, welches
Verkehrsmittel benutzt wurde. Erweitern Sie dafür die
<code>go</code>-Struktur aus der vorangegangenen Teilaufgabe um ein
Argument <code>Transport</code>.
</p>

<div class="org-src-container">
<pre class="src src-prolog">      travel(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>,go(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>,<span style="color: #BA36A5;">Transport</span>)) :- onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>,<span style="color: #BA36A5;">Transport</span>).
      travel(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>,go(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Z</span>,<span style="color: #BA36A5;">Transport</span>,<span style="color: #BA36A5;">Path</span>)) :- onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Z</span>,<span style="color: #BA36A5;">Transport</span>),
              travel(<span style="color: #BA36A5;">Z</span>,<span style="color: #BA36A5;">Y</span>,<span style="color: #BA36A5;">Path</span>).

      onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>,byCar) :- byCar(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>).
      onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>,byTrain) :- byTrain(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>).
      onestep(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>,byPlane) :- byPlane(<span style="color: #BA36A5;">X</span>,<span style="color: #BA36A5;">Y</span>).      </pre>
</pre>
</div></li>
</ol></li>
</ol>
</div>
</div>
<div id="outline-container-orgc167185" class="outline-3">
<h3 id="orgc167185"><span class="section-number-3">2.6</span> Aufgabe (Prolog - Bauklötze)</h3>
<div class="outline-text-3" id="text-2-6">
<p>
Gegeben ist eine Welt von Bauklötzen, wie sie in der folgenden
Abbildung zusehen ist:
</p>


<div class="figure">
<p><img src="./baukloetze.png" alt="baukloetze.png" />
</p>
</div>

<p>
Die folgenden Prädikate dienen zur Modellierung dieser Bauklotzwelt:
</p>

<dl class="org-dl">
<dt><code>am_boden(K)</code></dt><dd>K liegt auf dem Boden.</dd>
<dt><code>auf(K1, K2)</code></dt><dd>K1 liegt direkt auf K2.</dd>
<dt><code>links_von(K1, K2)</code></dt><dd>K1 und K2 liegen auf dem Boden und K1 liegt
direkt links von K2.</dd>
</dl>

<p>
Bearbeiten Sie die folgenden Aufgaben:
</p>
<ol class="org-ol">
<li>Formulieren Sie die Fakten, die die Bauklotzwelt aus der Abbildung
modelliert.</li>
<li><p>
Unter ausschließlicher Verwendung dieser Fakten, schreiben Sie die
folgenden Prädikate:
</p>
<dl class="org-dl">
<dt><code>basis(K1, K2)</code></dt><dd>K2 ist die Basis des Turms, der K1
enthält. Z. B. ist <i>j</i> die Basis von <i>h</i> in der Abbildung.</dd>
<dt><code>basis_rechts(K1, K2)</code></dt><dd>K1 und K2 liegen beide auf dem Boden
und K2 liegt rechts (nicht notwendig direkt benachbart) von K1.</dd>
<dt><code>objekt_rechts(K1, K2)</code></dt><dd>K2 befindet sich in einem Turm auf der
rechten Seite (nicht notwendig direkt benachbart) des Turms,
der K1 enthält.</dd>
</dl>
<p>
Die drei Prädikate müssen für jede Welt funktionieren, die mittels
der Fakten <code>am_boden/1</code>, <code>auf/2</code> und <code>links_von/2</code>.
</p></li>

<li><p>
Nun werden die „Bauklötze” verallgemeinert, indem verschiedene
Arten eingeführt werden, die &#x2013; abhängig von ihrer äußeren Form &#x2013;
aufeinander stapelbar sind oder nicht. Es gibt <i>Würfel</i>, <i>Kugeln</i>,
<i>Pyramiden</i> und <i>Reifen</i>. Es soll ein Prädikat entwickelt werden,
das die Frage beantwortet, ob ein Turm, gebaut aus diesen
„Bauklötzen”, gemäß der folgenden Regeln stabil ist:
</p>
<ul class="org-ul">
<li>Ein Reifen kann auf jeden Bauklotz gestapelt werden.</li>
<li>Ein Reifen ist der einzige Bauklotz, der auf eine Pyramide
gestapelt werden kann. In diesem Fall ragt die Spitze der
Pyramide aber aus dem Reifen heraus, sodass auf diese
„Konstruktion” nur ein weiterer Reifen gestapelt werden
dürfte. Auf diesen zweiten Reifen könnte dann jedes beliebige
Objekt gestapelt werden.</li>
<li>Eine Kugel darf nur auf einen Reifen gestapelt werden, sie darf
auch nicht auf dem Boden liegen.</li>
</ul>
<p>
Bearbeiten Sie die folgenden Teilaufgaben:
</p>
<ol class="org-ol">
<li value="1"><p>
Schreiben Sie ein Prädikat, das jedem Bauklotz einen Typ gemäß
der folgenden Tabelle zuordnet: 
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Klotz</th>
<th scope="col" class="org-left">Typ</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">a</td>
<td class="org-left">Pyramide</td>
</tr>

<tr>
<td class="org-left">b</td>
<td class="org-left">Reifen</td>
</tr>

<tr>
<td class="org-left">c</td>
<td class="org-left">Würfel</td>
</tr>

<tr>
<td class="org-left">d</td>
<td class="org-left">Kugel</td>
</tr>

<tr>
<td class="org-left">e</td>
<td class="org-left">Würfel</td>
</tr>

<tr>
<td class="org-left">f</td>
<td class="org-left">Reifen</td>
</tr>

<tr>
<td class="org-left">g</td>
<td class="org-left">Reifen</td>
</tr>

<tr>
<td class="org-left">h</td>
<td class="org-left">Kugel</td>
</tr>

<tr>
<td class="org-left">i</td>
<td class="org-left">Reifen</td>
</tr>

<tr>
<td class="org-left">j</td>
<td class="org-left">Pyramide</td>
</tr>
</tbody>
</table></li>
<li>Unter der Benutzung der Klotztypen und der Prädikate, die sich
auf die Position der Klötze beziehen (s. o.) schreiben Sie das
folgende Prädikat:
<dl class="org-dl">
<dt><code>instabil(K)</code></dt><dd>Das Objekt K kann nicht stabil auf seine
Basis in der gegebenen Konfiguration gestapelt werden.</dd>
</dl></li>
</ol></li>
</ol>
</div>
</div>
<div id="outline-container-orgaef68ca" class="outline-3">
<h3 id="orgaef68ca"><span class="section-number-3">2.7</span> Aufgabe (Arbeitsweise eines CLP-Systems)</h3>
<div class="outline-text-3" id="text-2-7">
<p>
Wie löst ein Constraint-Logic-Programming-System Gleichungen? Das
Verfahren unterscheidet sich grundsätzlich von denjenigen zur Lösung
linearer Gleichungssysteme (z. B. Gauß-Elimination). In einem
CLP-Programm werden Gleichungen nur aufgeschrieben und dann in einer
speziell codierten Form an einen internen Gleichungslöser
übergeben. Der versucht Werte für die Variablen zu finden, die die
Gleichungen lösen.
</p>

<p>
Um ein besseres Verständnis für die Arbeitsweise von CLP-Systemen zu
erlangen, übernehmen Sie in der folgenden Aufgabe die Rolle eines
Gleichungslösers.
</p>
</div>

<div id="outline-container-org05d1ae1" class="outline-4">
<h4 id="org05d1ae1">Modellierung des Problems</h4>
<div class="outline-text-4" id="text-org05d1ae1">
<p>
Gegeben sei der folgende Netzplan (vereinfacht) eines Projekts:
<img src="./netzplan.png" alt="netzplan.png" />
Die Aktivitäten sind durch Buchstaben und die Dauer deren Dauer durch
ganze Zahlen dargestellt.
</p>

<p>
Unter der Annahme, dass das Projekt nach spätestens 10 Zeiteinheiten
beendet sein muss und wir je eine Variable (mit endlichem
Wertebereich) zur Definition des Zeitpunkts, an dem die zugehörige
Aktivität starten kann, verwenden, kann das Problem wie folgt
modelliert werden:
\[a, b, c, d, e, f, g \in \{0, \ldots , 10\} \\
a \leq b, c, d \\
b + 1 \leq e \\
c + 2 \leq e \\
c + 2 \leq f \\
d + 3 \leq f \\
e + 4 \leq g \\
f + 1 \leq g \]
</p>

<p>
Der Wert jeder Variablen &#x2013; eine Menge, initialisiert mit
\(\{0,\ldots,10\}\) &#x2013; beschreibt die Zeitpunkt, zu denen die zugehörige
Aktivität gestartet werden kann.
</p>
</div>
</div>

<div id="outline-container-orgdf017a2" class="outline-4">
<h4 id="orgdf017a2">Aufgabe 1</h4>
<div class="outline-text-4" id="text-orgdf017a2">
<p>
In der folgenden Tabelle werden die Wertebereiche der Variablen
dargestellt. Diese Wertebereiche sind Schritt für Schritt durch
Anwenden der obigen Ungleichungen zu verkleinern. Schritt 0 zeigt die
Initialisierung der Variablen mit dem Wertebereich \(\{0, \ldots ,10\}\).
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Schritt</th>
<th scope="col" class="org-right">a</th>
<th scope="col" class="org-right">b</th>
<th scope="col" class="org-right">c</th>
<th scope="col" class="org-right">d</th>
<th scope="col" class="org-right">e</th>
<th scope="col" class="org-right">f</th>
<th scope="col" class="org-right">g</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0..9</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">1..10</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0..8</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">2..10</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>
</tbody>
</table>
<p>
In Schritt 1 wurde die Ungleichung \(b + 1 \leq e\) angewendet. Da zuvor
\(b \in \{0..10\}\) und  \(e \in \{0..10\}\) galt, kann leicht abgeleitet
werden, dass \(b\) nun als höchsten Wert \(9\) und \(e\) als minimalen Wert
\(1\) haben kann. Durch Anwenden der Ungleichung werden die Wertebereiche von
\(b\) und \(e\) auf \(\{0..9\}\) bzw. \(\{1..10\}\) verkleinert. Schritt 2
zeigt eine ähnliche Überlegung für die Ungleichung \(c + 2 \leq e\).
</p>

<p>
Vervollständigen Sie die Tabelle, indem Sie weitere Ungleichungen
anwenden, bis ein Fixpunkt, an dem keine weiteren Änderungen der
Wertebereiche vorgenommen werden können, erreicht ist.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Schritt</th>
<th scope="col" class="org-right">a</th>
<th scope="col" class="org-right">b</th>
<th scope="col" class="org-right">c</th>
<th scope="col" class="org-right">d</th>
<th scope="col" class="org-right">e</th>
<th scope="col" class="org-right">f</th>
<th scope="col" class="org-right">g</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
<td class="org-right">0..10</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0..9</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">1..10</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0..8</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">2..10</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">2..10</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0..7</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">3..10</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">2..6</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">6..10</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">3..9</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-right">0..7</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0..5</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0..4</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">0..6</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-right">0..4</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org940a1c2" class="outline-4">
<h4 id="org940a1c2">Aufgabe 2</h4>
<div class="outline-text-4" id="text-org940a1c2">
<p>
Lösen Sie das Problem für den Fall, dass das Projekt nach 6
Zeiteinheiten beendet sein muss. Fügen Sie dazu das Constraint 
\(g \in \{ 6 \}\) hinzu und ergänzen Sie obige Tabelle um weitere Schritte.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">Schritt</td>
<td class="org-left">a</td>
<td class="org-left">b</td>
<td class="org-right">c</td>
<td class="org-right">d</td>
<td class="org-right">e</td>
<td class="org-right">f</td>
<td class="org-right">g</td>
</tr>

<tr>
<td class="org-right">12</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">6</td>
</tr>

<tr>
<td class="org-right">13</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">2</td>
<td class="org-right">3..5</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">14</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">0..3</td>
<td class="org-right">0..2</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">0..1</td>
<td class="org-right">0</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">16</td>
<td class="org-left">0</td>
<td class="org-left">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
<td class="org-right">&#xa0;</td>
</tr>

<tr>
<td class="org-right">Endergebnis</td>
<td class="org-left">0</td>
<td class="org-left">0..1</td>
<td class="org-right">0</td>
<td class="org-right">0..2</td>
<td class="org-right">2</td>
<td class="org-right">3..5</td>
<td class="org-right">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Autor: Johannes Brauer</p>
<p class="date">Created: 2017-09-20 Wed 11:07</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>